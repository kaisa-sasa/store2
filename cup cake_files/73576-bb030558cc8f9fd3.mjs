(self.modernJsonp=self.modernJsonp||[]).push([["73576"],{932334:function(e,t,n){var i;n.r(t),n.d(t,{default:()=>s});let r={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"UnifiedFiltersContext_oneBarModules",selections:[i={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"moduleType",storageKey:null},{alias:null,args:null,concreteType:"OneBarModuleAction",kind:"LinkedField",name:"action",plural:!1,selections:[{alias:null,args:null,concreteType:"FilterOption",kind:"LinkedField",name:"filters",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"isSelected",storageKey:null},i,{alias:null,args:null,concreteType:"OneBarModuleDisplay",kind:"LinkedField",name:"display",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"displayText",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"OneBarModuleAction",kind:"LinkedField",name:"action",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"feedUrl",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],type:"OneBarModule",abstractKey:null};r.hash="92b841173868ce353dd00b5fce287546";let s=r},478300:function(e,t,n){n.d(t,{Z:()=>i});async function i(e){let t=await fetch(e);return new File([await t.blob()],"image.png")}},735815:function(e,t,n){n.d(t,{Z:()=>i});async function i(e,t){return await new Promise(n=>{let i=new FileReader;i.onload=()=>{let r=new Image;r.src=i.result,r.onload=()=>{let{height:i,width:s}=r;s>474&&(i*=474/s,s=474),t({src:r.src,height:i,width:s});let a=document.createElement("canvas");a.width=s,a.height=i;let o=a.getContext("2d");null!==o&&o.drawImage(r,0,0,s,i),a.toBlob(t=>{n(new File([t],e.name,{type:"image/jpeg"}))},"image/jpeg",.9)}},i.readAsDataURL(e)})}},310878:function(e,t,n){n.d(t,{N$:()=>C,wy:()=>B,VA:()=>T});var i,r=n(667294),s=n(167912),a=n(433100),o=n(675450),l=n(17832),c=n(856853);let d=(e,t,n)=>n&&(0,l.nZ)(n,t)?o.v.MODIFIED:(0,l.B1)(t,e)||n&&(0,l.Uv)(n,e)||(0,l.Uv)(t,e)?o.v.CLEARED:o.v.APPLIED;function u(e,t){(0,l.ph)(t);let n=e.find(e=>e?.id===t.id),i=n?.rules,r=n?.filter_options?.find(e=>"selectedOptionId"in t&&e.id===t.selectedOptionId)?.rules||i;if(!r)return[e,[]];let s=[],a=[];return e.forEach(e=>{void 0!==e.product_filter_type&&r.includes(e.product_filter_type)?s.push(e):a.push(e)}),[s,a]}function p(e,t){switch(t.type){case"RESET_FILTERS":let[n,i]=t.payload,r=n,s=(0,c.Z)(i)?(0,l.iP)(n):i;return Object.values(s).forEach(e=>{let[t]=u(r,e);r=t}),{models:n,availableFilterModels:r,appliedFilters:i,filters:s,isFetching:!1,pendingDeletedSelections:{},status:d(n,i,s)};case"CLEAR_FILTERS":let a=e.models,p=(0,l.P5)(e.models);return Object.values(p).forEach(e=>{let[t]=u(a,e);a=t}),{...e,filters:p,availableFilterModels:a,pendingDeletedSelections:{},status:d(e.models,e.appliedFilters,p)};case"UPDATE_FILTER":let{payload:h}=t,[g,x]=u(e.models,h),m={...e.filters,[h.id]:h},_={...e.pendingDeletedSelections};return g.forEach(e=>{if(!e.id)return;let t=_[e.id];t&&(m[e.id]=t,delete _[e.id])}),x.forEach(e=>{if(!e.id)return;let t=m[e.id];t&&(_[e.id]=t,delete m[e.id])}),(0,l.ph)(h,e.models.find(e=>e.id===h.id))&&delete m[h.id],{...e,availableFilterModels:g,filters:m,pendingDeletedSelections:_,status:d(e.models,e.appliedFilters,m)};case"SUBMIT_FILTER":return{...e,pendingDeletedSelections:{},status:o.v.SUBMITTED};case"SUBMIT_FAILED":return{...e,status:o.v.FAILED};case"SUBMIT_COMPLETE":let{filters:f}=e;return{...e,appliedFilters:f,pendingDeletedSelections:{},status:d(e.models,f)};case"LOADING":return{...e,isFetching:!0};case"LOADING_COMPLETED_OR_FAILED":return{...e,isFetching:!1};default:return e}}var h=n(178226),g=n(735243),x=n(250182),m=n(655068),_=n(531624),f=n(360033);let y=new Set([1,0,3,6,7,8,9]),v=(e,t,n)=>{let i=t?.find(({product_filter_type:e})=>e===n);if(!i)return;let r=e.findIndex(({product_filter_type:e})=>e===n);e[r]?e[r]=i:e.push(i)},b=(e,t,n)=>{let i=t?.find(({product_filter_type:e})=>e===n);if(!i)return e;let r=e.findIndex(({product_filter_type:e})=>e===n);return e[r]?e[r]=i:e.push(i),e};var S=n(252974),w=n(213491),I=n(661376),j=n(148),k=n(657476),E=n(785893);let A=()=>{},{Provider:P,getMaybe:T}=(0,w.Z)("UnifiedFiltersContext"),L=({applyInitFilters:e,children:t,filterModels:n,filters:i,isFetching:s,refreshFiltersData:a})=>{let{query:c}=(0,j.n)(),d=(0,S.Z)(),{getCachedFilters:u,cacheUnifiedFilterModelsWithProductFilters:w}=function(){let[e,t]=(0,r.useState)([]),[n,i]=(0,r.useState)(null),s=(0,_.Z)(),a=(0,x.Z)(),o=(0,h.Z)(),l=(0,g.Z)(),c=(0,m.Z)(),d=(0,r.useCallback)(({unifiedFilterModels:r,baseCacheKey:d})=>{let u=r?.filter(({product_filter_type:e})=>void 0!==e&&y.has(e));if(!u||u?.length===0||!d)return;let p=d!==n,h=p?[]:e;(p||!s)&&v(h,u,1),(p||!a)&&v(h,u,0),(p||!o)&&v(h,u,3),(p||!l)&&v(h,u,6),(p||!c)&&[7,8,9].forEach(e=>{v(h,u,e)}),(0,f.ZP)(h,e)||(t(h),i(d))},[e,o,l,a,c,s,n]);return{getCachedFilters:(0,r.useCallback)(t=>{if(!t||t?.length===0)return[];let n=[...t];return s&&(n=b(n,e,1)),a&&(n=b(n,e,0)),o&&(n=b(n,e,3)),l&&(n=b(n,e,6)),c&&[7,8,9].forEach(t=>{n=b(n,e,t)}),n},[e,o,l,a,c,s]),cacheUnifiedFilterModelsWithProductFilters:d}}(),I=e?.(n)||i||{},[k,A]=(0,r.useReducer)(p,{models:n,availableFilterModels:n,appliedFilters:I,filters:I,pendingDeletedSelections:{},isFetching:s,status:(0,l.B1)(I,n)||(0,l.Uv)(I,n)?o.v.CLEARED:o.v.APPLIED}),[T,L]=(0,r.useState)(n);(0,r.useEffect)(()=>{s&&A({type:"LOADING"})},[s]),(0,r.useEffect)(()=>{if(s||k.isFetching&&0===n.length)return;if(!(0,l.a$)(T,n))return void A({type:"LOADING_COMPLETED_OR_FAILED"});let t=n;d||(t=u([...n]),w({unifiedFilterModels:[...n],baseCacheKey:c})),A({type:"RESET_FILTERS",payload:[t,e?.(t)||{}]}),L(n)},[e,n,T,s,k.isFetching,u,w,c,d]);let C=(0,r.useMemo)(()=>({filterState:k,dispatch:A,refreshFiltersData:a}),[k,a]);return(0,E.jsx)(P,{value:C,children:t})},C=({bookmark:e="",children:t,generateInitFilterCb:n})=>{let i=(0,S.Z)(),{data:r=null,refresh:s,isLoaded:o}=(0,I.Z)(!i&&e?{name:"ApiResource",options:{url:"/v3/filters/",data:{bookmark_string:e}}}:null),{cachedProductFilterOneBarModules:c}=(0,a.l)(),d=c.map(l.tx).filter(Boolean);return(0,E.jsx)(L,{applyInitFilters:n,filterModels:(i?d:r)||[],isFetching:i?0===d.length:!o||!e,refreshFiltersData:s,children:t})},Z=(void 0!==i||(i=n(932334)).hash&&"92b841173868ce353dd00b5fce287546"!==i.hash&&console.error("The definition of 'UnifiedFiltersContext_oneBarModules' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),i),B=({children:e,oneBarModulesKey:t})=>{let{data:n,isFetching:i,isLoaded:a}=(0,k.Z)(),{oneBarModules:l}=n||{},c=(0,s.useFragment)(Z,t),d=(0,r.useMemo)(()=>({dispatch:()=>{},filterState:{models:[],availableFilterModels:[],appliedFilters:{},filters:{},isFetching:i,pendingDeletedSelections:{},status:o.v.CLEARED},refreshFiltersData:A}),[i]),u=(c?[c]:l?.map(e=>e&&{action:e.action?{filters:e.action.filters?e.action.filters.map(e=>({isSelected:e.is_selected??null,id:e.id??null,display:e.display?{displayText:e.display.display_text??null}:null,action:e.action?{feedUrl:e.action.feed_url??null}:null})):null}:null,id:e.id??null,moduleType:e.module_type??null}))?.find(({moduleType:e})=>0===e),p=u?.action?.filters;if(!u||!p)return(0,E.jsx)(P,{value:d,children:e});let h=u.id||"",g={[h]:{id:h,selectedOptionId:p.find((e,t)=>e?.isSelected&&0!==t)?.id||"",type:"single",lastChangedLocation:1}};return(0,E.jsx)(L,{filterModels:[{filter_component_type:2,filter_options:p.map((e,t)=>({label:e?.display?.displayText||"",id:e?.id||"",string_value:e?.action?.feedUrl||"",is_selected:"boolean"==typeof e?.isSelected?e.isSelected:0===t})),id:h,title:"",product_filter_type:4}],filters:g,isFetching:!a,refreshFiltersData:A,children:e})}},675450:function(e,t,n){n.d(t,{$:()=>i,v:()=>r});let i=50,r={APPLIED:"applied",CLEARED:"cleared",MODIFIED:"modified",SUBMITTED:"submitted",FAILED:"failed"}},190665:function(e,t,n){n.d(t,{Z:()=>d});var i=n(433100),r=n(310878),s=n(17832),a=n(986475),o=n(537701),l=n(629724),c=n(148);function d(){let{brands:e,colors:t,domains:n,onSale:d,priceMax:u,priceMin:p}=(0,c.n)(),h=(0,r.VA)(),{cachedProductFilterOneBarModules:g}=(0,i.l)(),x=Number((0,l.Z)().filter_location);if(1===x){let{filterState:e}=h||{};return e?(0,s.Ax)(e.appliedFilters,e.models):null}if(0===x){let i=(0,a.Z)(o.Z,!0)(g.map(e=>e.action?.filter).filter(Boolean));return(0,s.vJ)({brandsParam:e,colorsParam:t,domainsParam:n,onSaleParam:d,priceMaxParam:u,priceMinParam:p,unifiedFilterModels:i})}return null}},17832:function(e,t,n){n.d(t,{Ak:()=>w,Ax:()=>v,B1:()=>p,LG:()=>S,P5:()=>x,UP:()=>I,Uv:()=>h,a$:()=>d,eF:()=>j,i7:()=>_,iP:()=>g,nZ:()=>c,ph:()=>u,rc:()=>y,tx:()=>b,vJ:()=>f});var i=n(675450),r=n(360033),s=n(477738);let a=e=>e.map(({filter_component_type:e,filter_options:t,title:n})=>({filter_component_type:e,filter_options:t?.map(({id:e,label:t,count:n,image_url:i,is_verified:r,numeric_value:s,string_value:a,unit:o})=>({id:e,label:t,count:n,image_url:i,is_verified:r,numeric_value:s,string_value:a,unit:o})),title:n})),o=(e,t)=>{if(!e&&!t)return!1;if(!e||!t)return!0;if("single"===e.type&&"single"===t.type)return e.selectedOptionId!==t.selectedOptionId;if("multi"===e.type&&"multi"===t.type)return!(0,r.ZP)(e.selectedOptionIds,t.selectedOptionIds);if("range"===e.type&&"range"===t.type)return e.min!==t.min||e.max!==t.max;throw Error("Filter type specific return must be specified")},l=e=>!e||!Object.keys(e).length,c=(e,t)=>{if(l(e)&&l(t))return!1;if(l(e)||l(t)||e&&t&&Object.entries(e).length!==Object.entries(t).length)return!0;for(let n in e)if(o(e[n],t?.[n]))return!0;return!1},d=(e,t)=>!(0,r.ZP)(a(e),a(t)),u=(e,t)=>{if("single"===e.type)return!e.selectedOptionId;if("multi"===e.type)return 0===e.selectedOptionIds.size;if("range"===e.type)return!!t?.filter_options&&e.min===t.filter_options[0]?.numeric_value&&e.max===t.filter_options[2]?.numeric_value;throw Error("Filter type specific return must be specified")},p=(e,t)=>{try{for(let n in e){let i=e[n],r=t.find(e=>e.id===i?.id);if(i&&!u(i,r))return!1}return!0}catch(e){return!0}},h=(e,t)=>{if(!t||0===t.length)return!1;let n=t[0];if(!n)return!1;switch(n?.filter_component_type){case 2:let i=n.filter_options?.[0];for(let t in e){let n=e[t];if(!n)break;if("selectedOptionId"in n&&n.selectedOptionId===i?.id)return!0}return!1;case 1:for(let t in e){let i=e[t];if(!i)break;if(i.id===n.id&&"selectedOptionIds"in i&&0===i.selectedOptionIds.size)return!0}return!1;default:return!1}},g=e=>e.map(e=>{switch(e.filter_component_type){case 2:let t=e.filter_options?.find(e=>e.is_selected)?.id;return t?{selectedOptionId:t,id:e.id,type:"single"}:null;case 1:let n=e.filter_options?.filter(e=>e.is_selected).map(({id:e})=>e);return n&&n.length>0?{selectedOptionIds:new Set(n),id:e.id,type:"multi"}:null;default:return null}}).reduce((e,t)=>t?{...e,[t.id]:t}:e,{}),x=e=>{if(!e||0===e.length)return{};let t=e[0];switch(t?.filter_component_type){case 2:let n=t.filter_options?.[0]?.id;return n&&"string"==typeof t.id?{[t.id]:{selectedOptionId:n,lastChangedLocation:1,id:t.id,type:"single"}}:{};case 1:return"string"==typeof t.id?{[t.id]:{selectedOptionIds:new Set,lastChangedLocation:1,id:t.id,type:"multi"}}:{};default:return{}}},m=e=>e.map(e=>{let{filter_id:t,filter_options:n,product_filter_type:i}=e,r=t;return"number"==typeof i&&(r+=`_${i}`),n.length>0&&(r+=":",n.forEach((e,t)=>{let{filter_option_id:i,numeric_value:s,string_value:a,unit:o}=e;r+=`${i}`,"number"==typeof s&&(r+=`_${s}`),"string"==typeof a&&(r+=`_${a}`),"string"==typeof o&&(r+=`_${o}`),t<n.length-1&&(r+=",")})),r}).join("|"),_=({brands:e,colors:t,domains:n,onSale:i,priceMax:r,priceMin:a,scope:o,unifiedFilterModels:l})=>{let c={};for(let{filter_options:d,id:u,product_filter_type:p}of l)if(u&&d?.length){if(1===p&&("number"==typeof a||"number"==typeof r)){let[e,t,n,i]=d,s=a??n?.numeric_value??e?.numeric_value??0,o=r??i?.numeric_value??t?.numeric_value??100;c[u]={min:s,max:o,id:u,type:"range",lastChangedLocation:1}}if(0===p&&n&&n.length>0){let e=n.map(e=>{let t=d.find(({string_value:t})=>t===e);return t?t.id:null}).filter(Boolean);e.length>0&&(c[u]={id:u,lastChangedLocation:1,selectedOptionIds:new Set(e),type:"multi"})}if(3===p&&e&&e.length>0){let t=e.map(e=>{let t=d.find(({string_value:t})=>t===e);return t?t.id:null}).filter(Boolean);t.length>0&&(c[u]={id:u,lastChangedLocation:1,selectedOptionIds:new Set(t),type:"multi"})}if(6===p&&t&&t.length>0){let e=t.map(e=>{let t=d.find(({string_value:t})=>t===e);return t?t.id:null}).filter(Boolean);e.length>0&&(c[u]={id:u,lastChangedLocation:1,selectedOptionIds:new Set(e),type:"multi"})}if(4===p&&o){let e=(0,s.gi)(o),t=d.find(({search_type:t})=>t===e);t?.id&&(c[u]={id:u,lastChangedLocation:1,selectedOptionId:t.id,type:"single"})}if("number"==typeof p&&new Set([7,8,9]).has(p)&&i){let e=d[0]?.id;e&&(c[u]={id:u,lastChangedLocation:1,selectedOptionId:e,type:"single"})}}return c},f=({brandsParam:e,colorsParam:t,domainsParam:n,onSaleParam:i,priceMaxParam:r,priceMinParam:s,unifiedFilterModels:a})=>{let o=[],l=Number(s),c=Number(r),d=Number.isNaN(l)?void 0:l,u=Number.isNaN(c)?void 0:c,p=n?.split(",").filter(Boolean)??[],h=e?.split(",").filter(Boolean)??[],g=t?.split(",").filter(Boolean)??[];for(let{filter_options:e,id:t,product_filter_type:n}of a)if(t&&e?.length){if(1===n&&"number"==typeof d&&"number"==typeof u){let i={filter_id:t,filter_options:e.slice(0,2).filter(e=>void 0!==e.id).map((e,t)=>({filter_option_id:e.id,numeric_value:0===t?d:u,unit:e.unit||"USD"})),location:0,product_filter_type:n};o.push(i)}if(0===n&&p&&p.length>0){let i=p.map(t=>{let n=e.find(e=>e.string_value===t);return n?n.id:null}).filter(Boolean);if(i.length>0){let e={filter_id:t,filter_options:i.map(e=>({filter_option_id:e,string_value:e})),location:0,product_filter_type:n};o.push(e)}}if(3===n&&h&&h.length>0){let i=h.map(t=>{let n=e.find(e=>e.string_value===t);return n?n.id:null}).filter(Boolean);if(i.length>0){let e={filter_id:t,filter_options:i.map(e=>({filter_option_id:e,string_value:e})),location:0,product_filter_type:n};o.push(e)}}if(6===n&&g&&g.length>0){let i=g.map(t=>{let n=e.find(e=>e.string_value?.toLowerCase()===t.toLowerCase());return n?n.id:null}).filter(Boolean);if(i.length>0){let e={filter_id:t,filter_options:i.map(e=>({filter_option_id:e,string_value:e})),location:0,product_filter_type:n};o.push(e)}}if(7===n&&i){let r=e[0]?.id;if(r){let e={filter_id:t,filter_options:[{filter_option_id:r,numeric_value:Number(i)}],location:0,product_filter_type:n};o.push(e)}}}return 0===o.length?null:m(o)},y=({filterMap:e,isInWebHundredPercentProductLoadExp:t,models:n})=>{let i=null,r=null,a=!1,o=null,l=null,c=null,d=null,u=null;for(let p in e){let h=e[p];if(h){let e=n.find(e=>e.id===h.id);if(e)if("range"===h.type&&1===e.product_filter_type)c=h.min,l=h.max;else if("multi"===h.type&&0===e.product_filter_type){let t=e.filter_options?.filter(e=>h.selectedOptionIds.has(e.id||""));o=t?.map(e=>e.string_value).filter(Boolean)}else if("multi"===h.type&&3===e.product_filter_type){let t=e.filter_options?.filter(e=>h.selectedOptionIds.has(e.id||""));i=t?.map(e=>e.string_value).filter(Boolean)}else if("multi"===h.type&&6===e.product_filter_type){let t=e.filter_options?.filter(e=>h.selectedOptionIds.has(e.id||""));r=t?.map(e=>e.string_value).filter(Boolean)}else if("single"===h.type&&4===e.product_filter_type){let n=e.filter_options?.find(e=>h.selectedOptionId===e.id),i=n&&void 0!==n.search_type?(0,s.zh)(n.search_type):s.lw.PINS;u=i,t&&(u=i===s.lw.PINS_BUYABLE?s.lw.PINS:i,a=i===s.lw.PINS_BUYABLE)}else"single"===h.type&&7===e.product_filter_type&&(d=e.filter_options?.[0]?.numeric_value)}}let p=n.find(e=>4===e.product_filter_type),h=p?.filter_options?.find(e=>e.is_selected);return null===u&&"number"==typeof h?.search_type&&(u=(0,s.zh)(h.search_type)),{brands:i,colors:r,commerce_only:a,domains:o,max:l,min:c,on_sale:d,scope:u}},v=(e,t)=>{let n=[];return(Object.entries(e).forEach(([e,i])=>{let r=t.find(e=>e.id===i.id);if(!r||4===r.product_filter_type||"number"!=typeof r.product_filter_type||!r.filter_options)return;let s=[];if("range"===i.type){let[e,t]=r.filter_options;if(!e?.id||!t?.id)return;s=[{filter_option_id:e.id,numeric_value:i.min,unit:e.unit},{filter_option_id:t.id,numeric_value:i.max,unit:t.unit}]}if("single"===i.type){let e=r.filter_options.find(e=>e.id===i.selectedOptionId);if(!e?.id)return;s=[{filter_option_id:e.id,numeric_value:e.numeric_value,string_value:e.string_value}]}if("multi"===i.type){let e=r.filter_options.filter(e=>e.id&&i.selectedOptionIds.has(e.id));if(0===e.length)return;s=e.filter(e=>void 0!==e.id).map(e=>({filter_option_id:e.id,numeric_value:e.numeric_value,string_value:e.string_value}))}n.push({filter_id:e,filter_options:s,location:i.lastChangedLocation,product_filter_type:r.product_filter_type})}),n&&0!==n.length)?m(n):null},b=e=>{let{filter:t,title:n}=e.action||{},{title:i}=t||{},r=n||i;if(!t||!r)return null;let{filterComponentType:s,productFilterType:a,id:o}=t,l=(t.filterOptions||[]).filter(Boolean);if(void 0===s||void 0===l||0===l.length||null==a||null==o)return null;let c=(e=>{let t=e.map(e=>{if(!e)return null;let{auxData:t,id:n,imageUrl:i,isVerified:r,label:s,numericValue:a,searchType:o,stringValue:l,unit:c,rules:d}=e;return null===i||null===i||null===a||null===r||null===l||null===c?null:{id:n||"",label:s||"",count:0,image_url:i,is_verified:r,numeric_value:a,...d?{rules:[...d]}:{},..."number"==typeof o?{search_type:o}:{},string_value:l,unit:c,..."string"==typeof t?.moduleId?{aux_data:{module_id:t.moduleId}}:{}}}).filter(Boolean);return t.length>0?t:null})(l);return c?{filter_component_type:s,filter_options:[...c],id:o||"",product_filter_type:a,title:r}:null};function S(e,t,n){let[r,s,a,o]=n,{numeric_value:l=0}=o??r??{},{numeric_value:c=l+i.$}=a??s??{},{unit:d="USD"}=r??{},u=e.filters[t]?.type==="range"?e.filters[t]:{min:l,max:c,id:t,type:"range",lastChangedLocation:1};return{defaultMax:c,defaultMin:l,unit:d,range:u}}function w(e){return"multi"!==e.type?e:{...e,selectedOptionIds:new Set}}function I(e,t){let n=[];return Object.entries(t).forEach(([t,i])=>{let r=e.find(e=>e?.id===t);if(r){let e=r.aux_data?.module_id;e&&n.push(e);let t=("multi"===i.type?Array.from(i.selectedOptionIds):"single"===i.type?[i.selectedOptionId]:[]).map(e=>{let t=r.filter_options?.find(t=>t.id===e);return t?.aux_data?.module_id||""}).filter(Boolean);n.push(...t)}}),n}function j(e,t){let n=[];return Object.keys(t).forEach(t=>{let i=e.find(e=>e?.id===t);if(i){let e=i.product_filter_type;e&&n.push(e)}}),n}},115366:function(e,t,n){n.d(t,{Z:()=>l});var i=n(686659),r=n(667294),s=n(740097),a=n(785893);let o={MOBILE:{HEIGHT_PX:64,WIDTH_PX:48},SMALL:{HEIGHT_PX:72,WIDTH_PX:54},DEFAULT:{HEIGHT_PX:96,WIDTH_PX:72},LARGE:{HEIGHT_PX:130,WIDTH_PX:98}};function l({fanOut:e,card:t,index:n,size:l,rounding:c}){let d;(0,r.useEffect)(()=>{(0,i.Z)("PinCard","/app/packages/StructuredFeed/ItemReps/MoreIdeasRep/PinCard.tsx")},[]);let u=o[l],{height:p=u.HEIGHT_PX,url:h,width:g=u.WIDTH_PX,colorRGB:x,opacity:m}=t;return h?d=(0,a.jsx)(s.Ee,{alt:h,fit:"cover",naturalHeight:p,naturalWidth:g,src:h}):x&&m&&(d=(0,a.jsx)(s.xu,{dangerouslySetInlineStyle:{__style:{backgroundColor:`rgba(${x.join(", ")}, ${m})`}},height:u.HEIGHT_PX,width:u.WIDTH_PX})),(0,a.jsx)(s.xu,{dangerouslySetInlineStyle:{__style:((e,t,n)=>{let i;switch(n){case"MOBILE":i={0:{transform:"rotate(-15deg)",top:"6px",left:"16px"},1:{transform:"rotate(0deg)",top:"3px",left:"30px"},2:{transform:"rotate(15deg)",top:"6px",left:"44px"}};break;case"SMALL":i={0:{transform:t?"rotate(-22deg)":"rotate(-15deg)",top:"12px",left:"12px"},1:{transform:t?"rotate(1deg)":"rotate(0deg)",top:t?"6px":"10px",left:"26px"},2:{transform:t?"rotate(24deg)":"rotate(15deg)",top:"12px",left:"40px"}};break;case"LARGE":i={0:{transform:t?"rotate(-26deg)":"rotate(-15deg)",top:"50px",left:"44px"},1:{transform:t?"rotate(1deg)":"rotate(0deg)",top:t?"36px":"40px",left:"68px"},2:{transform:t?"rotate(26deg)":"rotate(15deg)",top:"56px",left:"98px"}};break;default:i={0:{transform:t?"rotate(-22deg)":"rotate(-15deg)",top:"20px",left:"64px"},1:{transform:t?"rotate(1deg)":"rotate(0deg)",top:t?"10px":"14px",left:"82px"},2:{transform:t?"rotate(24deg)":"rotate(15deg)",top:"20px",left:"100px"}}}let r=i[e];return r.border="1px solid #FFFFFF",r.transition="all 150ms ease-out",r})(n,e,l)},position:"absolute",rounding:c??5,children:(0,a.jsx)(s.zd,{height:u.HEIGHT_PX,rounding:5,wash:!0,width:u.WIDTH_PX,children:d})})}},319528:function(e,t,n){n.d(t,{Z:()=>i});function i(e,t){return e.reduce((e,n)=>{let i="function"==typeof t?t(n):n[t];return i in e||(e[i]=[]),e[i].push(n),e},{})}},192336:function(e,t,n){n.d(t,{Z:()=>i});function i(){window&&window.focus(),document.activeElement&&document.activeElement.blur()}},439947:function(e,t,n){n.d(t,{Z:()=>b});var i=n(667294),r=n(213491),s=n(705460),a=n(774303),o=n(381571),l=n(449896),c=n(780764),d=n(217472),u=n(337751),p=n(139876),h=n(998727),g=n(679767),x=n(240083),m=n(296264);let _=(0,a.XV)("PwtStopwatch"),f=(e,t)=>{if(m.Z){if("start"===t.type&&!e.isTiming){let{name:n,startTime:i,navigationType:r}=t;return(0,s.A9)(`TIMING.${n}`),{isTiming:!0,name:n,isSampled:t.isSampled,startTime:"number"==typeof i?i:m.Z.now(),metricId:{type:"stopwatch",name:n,navigationType:r},pwtStaticContext:t.pwtStaticContext,annotations:e.annotations,binaryAnnotations:e.binaryAnnotations,spans:e.spans,traceId:e.traceId,spanNameUpdates:e.spanNameUpdates}}if(!e.isTiming)if(t.bypassIsTimingCheck)_("allowing action while stopwatch is not actively timing (bypassIsTimingCheck is set to true)",t);else{let n=t.name||e.name;return _("ignoring action - stopwatch is not actively timing",t),(0,s.A9)(`WARN.${n}.noTiming.${t.type}`),e}if("annotate"===t.type){let n=m.Z.now();return _(`adding annotation {${t.label}: ${n}}`),{...e,annotations:e.annotations.concat([{label:t.label,timestamp:n}])}}if("binaryAnnotate"===t.type)return _(`adding binary annotation {${t.name}: ${String(t.value)}}`),{...e,binaryAnnotations:{...e.binaryAnnotations,...{[t.name]:{value:t.value,type:t.annotationType}}}};if("binaryAnnotateOperation"===t.type){let{value:n,type:i}=t.binaryAnnotationValueAndType;if(!e.binaryAnnotations[t.name])return{...e,binaryAnnotations:{...e.binaryAnnotations,...{[t.name]:{value:n,type:i}}}};{let r=e.binaryAnnotations[t.name].value||0;return _(`operating on binary annotation {
          name: ${t.name}
          pervious value: ${String(r)}
          operand: ${String(n)}
        }`),{...e,binaryAnnotations:{...e.binaryAnnotations,...{[t.name]:{value:n?t.operation(r,n):r,type:i}}}}}}if("addSubspan"===t.type){_(`adding subspan {${t.name}}`),-1!==e.spans.findIndex(e=>e.name===t.name)&&_(`WARNING: adding duplicate subspan name {${t.name}}`);let n=t.id||(0,x.Z)();-1!==e.spans.findIndex(e=>e.id===n)&&_(`WARNING: adding duplicate subspan id {${t.name}: ${n}}`);let i=0;return t.startTime?i=t.startTime:e.startTime?i=e.startTime:_(`WARNING: adding subspan {${t.name}} without start time`),{...e,spans:[...e.spans,{name:t.name,id:n,startTime:i,endTime:t.endTime||1/0,annotationMap:{...t.annotations},binaryAnnotationMap:{...t.binaryAnnotations},parentId:t.parentId}]}}if("subspanStart"===t.type){_(`starting subspan {${t.name}}`),-1!==e.spans.findIndex(e=>e.name===t.name)&&_(`WARNING: starting duplicate subspan name {${t.name}}`);let n=t.id||(0,x.Z)();-1!==e.spans.findIndex(e=>e.id===n)&&_(`WARNING: starting duplicate subspan id {${t.name}: ${n}}`);let i=t.parentName?e.spans.find(e=>e.name===t.parentName)?.id:null;return{...e,spans:[...e.spans,{name:t.name,id:n,parentId:t.parentId||i,startTime:m.Z.now(),endTime:1/0,annotationMap:{...t.annotations},binaryAnnotationMap:{...t.binaryAnnotations}}]}}if("subspanStop"===t.type){_(`stopping subspan {${t.name}}`),!t.id&&e.spans.filter(e=>e.name===t.name).length>1&&(0,s.H)("duplicate_subspan_stop_name",{name:t.name,type:t.type});let n=t.id?e.spans.findIndex(e=>e.id===t.id):e.spans.findIndex(e=>e.name===t.name);return n>-1?(e.spans[n].endTime=m.Z.now(),t.annotations&&(e.spans[n].annotationMap={...e.spans[n].annotationMap,...t.annotations}),t.binaryAnnotations&&(e.spans[n].binaryAnnotationMap={...e.spans[n].binaryAnnotationMap,...t.binaryAnnotations})):(0,s.H)("invalid_subspan_stop_name",{name:t.name}),e}if("subspanUpdateName"===t.type){e.spans.filter(e=>e.name===t.currentName).length>1&&(0,s.H)("duplicate_subspan_stop_name",{name:t.currentName,type:t.type});let n=e.spans.findIndex(e=>e.name===t.currentName);return n>-1?t.updateWhenStopwatchCompletes?e.spanNameUpdates=[...e.spanNameUpdates,{currentName:t.currentName,newName:t.newName}]:(_(`renaming subspan {${t.currentName}} to {${t.newName}}`),e.spans[n].name=t.newName):(0,s.H)("no_subspan_found_to_rename",{name:t.currentName}),e}if("stop"===t.type&&e.isTiming){let{startTime:n,metricId:i,pwtStaticContext:r,annotations:s,binaryAnnotations:a,isSampled:p,spans:g,traceId:f}=e;if(t.stopwatchPerformanceObserver&&t.stopwatchPerformanceObserver.disconnect(),p){let o=t.stopTime||m.Z.now(),p=[...g.map(t=>{t.endTime===1/0&&(t.endTime=o);let n=e.spanNameUpdates.findIndex(e=>t.name===e.currentName);return n>-1&&(_(`renaming subspan {${t.name}} to {${e.spanNameUpdates[n].newName}}`),t.name=e.spanNameUpdates[n].newName,e.spanNameUpdates=e.spanNameUpdates.filter(e=>e.newName!==t.name)),t})];if(t.manualAndResourceSpans||0===g.length){let e=(0,x.Z)();p.push({name:"network_resources",id:e,startTime:n,endTime:o,annotationMap:{},binaryAnnotationMap:{},parentId:null},...(t.customStopwatchBuffer||[]).map(t=>(0,u.Z)((0,c.p)(t,[]),e)).filter(Boolean))}let y={type:"COMPLETE",metricId:i,traceId:f,startTime:n,endTime:o,spans:p,annotationMap:{...(0,h.Z)(s)},binaryAnnotationMap:(0,l.ng)({metricId:i,pwtStaticContext:r,binaryAnnotations:a,performanceResourceTimings:t.customStopwatchBuffer||[],type:"COMPLETE"})};(0,d.Z)({metricId:i,pwtStaticContext:r,result:y})}return(0,o.$B)(),{isTiming:!1,name:e.name,annotations:[],binaryAnnotations:{},spans:[],traceId:(0,x.Z)(),spanNameUpdates:[]}}if("error"===t.type){let{error:n,stopwatchPerformanceObserver:i}=t;return n&&(0,s.H)(n),i&&i.disconnect(),(0,o.$B)(),{isTiming:!1,name:e.name,annotations:[],binaryAnnotations:{},spans:[],traceId:(0,x.Z)(),spanNameUpdates:[]}}if("abort"===t.type&&e.isTiming){t.stopwatchPerformanceObserver&&t.stopwatchPerformanceObserver.disconnect();let n=t.reason||"",{startTime:i,metricId:r,pwtStaticContext:s,binaryAnnotations:a,traceId:c}=e,u={type:"ABORT",traceId:c,startTime:i,endTime:m.Z.now(),spans:[],annotationMap:{},binaryAnnotationMap:(0,l.ng)({metricId:r,pwtStaticContext:s,binaryAnnotations:a,performanceResourceTimings:t.customStopwatchBuffer||[],type:"ABORT"}),reason:n};return(0,d.Z)({metricId:r,pwtStaticContext:s,result:u}),(0,o.$B)(),{isTiming:!1,name:e.name,annotations:[],binaryAnnotations:{},spans:[],traceId:c,spanNameUpdates:[]}}}return e};var y=n(780657),v=n(785893);let b=({name:e,sampleRate:t,abortOnUnloadOrClientNavigation:n=!0,navigationType:a,manualAndResourceSpans:l=!1})=>{let{Provider:c,getMaybe:d}=(0,r.Z)(`Stopwatch_${e}`);return{Provider:function({children:r}){let d=(({name:e,sampleRate:t,navigationType:n,manualAndResourceSpans:r=!1})=>{let s=(0,p.Z)(),a=(0,i.useRef)([]),l=(0,i.useRef)(null),c=(0,i.useRef)(null);null===c.current&&(c.current=(0,o.jf)());let[d,u]=(0,i.useReducer)(f,{isTiming:!1,name:e,annotations:[],binaryAnnotations:{},spans:[],traceId:c.current,spanNameUpdates:[]});return s?{isTiming:d.isTiming,name:d.name,start:i=>(window.PerformanceObserver&&(a.current=[],l.current=(0,g.Z)({entryTypes:["resource"]},e=>{a.current=a.current.concat(e.getEntries()),a.current.length>1e3&&(a.current=a.current.slice(-1e3))})),u({type:"start",startTime:i,name:e,navigationType:n,pwtStaticContext:s,isSampled:!t||Math.random()<t})),stop:e=>u({type:"stop",stopTime:e,stopwatchPerformanceObserver:l.current,customStopwatchBuffer:a.current,manualAndResourceSpans:r}),error:e=>{u({type:"error",stopwatchPerformanceObserver:l.current,error:e})},abort:e=>u({type:"abort",stopTime:m.Z?.now(),stopwatchPerformanceObserver:l.current,customStopwatchBuffer:a.current,reason:e}),annotate:(e,t,n=!1)=>u({type:"annotate",label:e,parentId:t,bypassIsTimingCheck:n}),binaryAnnotate:(e,t,n,i,r=!1)=>u({type:"binaryAnnotate",name:e,value:t,annotationType:n,parentId:i,bypassIsTimingCheck:r}),binaryAnnotateOperation:({name:e,binaryAnnotationValueAndType:t,operation:n,parentId:i,bypassIsTimingCheck:r=!1})=>u({type:"binaryAnnotateOperation",name:e,binaryAnnotationValueAndType:t,operation:n,parentId:i,bypassIsTimingCheck:r}),addSubspan:({name:e,startTime:t,endTime:n,annotations:i={},binaryAnnotations:r={},parentId:s=null,id:a=null,bypassIsTimingCheck:o=!1})=>u({type:"addSubspan",name:e,startTime:t,endTime:n,annotations:i,binaryAnnotations:r,parentId:s,id:a,bypassIsTimingCheck:o}),subspanStart:({name:e,annotations:t={},binaryAnnotations:n={},parentId:i=null,parentName:r=null,id:s=null,bypassIsTimingCheck:a=!1})=>u({type:"subspanStart",name:e,annotations:t,binaryAnnotations:n,parentId:i,parentName:r,id:s,bypassIsTimingCheck:a}),subspanStop:({name:e,annotations:t,binaryAnnotations:n,id:i,parentId:r,bypassIsTimingCheck:s=!1})=>u({type:"subspanStop",name:e,annotations:t,binaryAnnotations:n,id:i,parentId:r,bypassIsTimingCheck:s}),subspanUpdateName:({currentName:e,newName:t,bypassIsTimingCheck:n,updateWhenStopwatchCompletes:i=!0})=>u({type:"subspanUpdateName",currentName:e,newName:t,bypassIsTimingCheck:n,updateWhenStopwatchCompletes:i}),getSpans:(e,t)=>d.spans.filter(n=>n[e]===t),getTraceId:()=>d.traceId}:null})({name:e,sampleRate:t,navigationType:a,manualAndResourceSpans:l}),u=(0,y.Z)(),h=u?u.time:0,x=(0,i.useRef)("NotStarted"),_=d?.isTiming,b=(0,i.useCallback)(t=>{"Started"===x.current?(x.current="Stopped",d?.abort(t)):(0,s.A9)(`WARN.${e}.noTiming.abort`)},[d]),S=(0,i.useCallback)((e,t)=>{d?.annotate(e,t)},[d]),w=(0,i.useCallback)((e,t,n,i)=>{d?.binaryAnnotate(e,t,n,i)},[d]),I=(0,i.useCallback)(({name:e,binaryAnnotationValueAndType:t,operation:n,parentId:i,bypassIsTimingCheck:r})=>{d?.binaryAnnotateOperation({name:e,binaryAnnotationValueAndType:t,operation:n,parentId:i,bypassIsTimingCheck:r})},[d]),j=(0,i.useCallback)(({name:e,startTime:t,endTime:n,annotations:i,binaryAnnotations:r,parentId:s,id:a,bypassIsTimingCheck:o})=>{d?.addSubspan({name:e,startTime:t,endTime:n,annotations:i,binaryAnnotations:r,parentId:s,id:a,bypassIsTimingCheck:o})},[d]),k=(0,i.useCallback)(({name:e,annotations:t,binaryAnnotations:n,parentId:i,parentName:r,id:s,bypassIsTimingCheck:a})=>{d?.subspanStart({name:e,annotations:t,binaryAnnotations:n,parentId:i,parentName:r,id:s,bypassIsTimingCheck:a})},[d]),E=(0,i.useCallback)(({name:e,annotations:t,binaryAnnotations:n,id:i,parentId:r,bypassIsTimingCheck:s})=>{d?.subspanStop({name:e,annotations:t,binaryAnnotations:n,id:i,parentId:r,bypassIsTimingCheck:s})},[d]),A=(0,i.useCallback)(({currentName:e,newName:t,bypassIsTimingCheck:n,updateWhenStopwatchCompletes:i})=>{d?.subspanUpdateName({currentName:e,newName:t,bypassIsTimingCheck:n,updateWhenStopwatchCompletes:i})},[d]),P=(0,i.useCallback)((e,t)=>d?d.getSpans(e,t):[],[d]),T=(0,i.useCallback)(()=>d?d.getTraceId():"",[d]),L=(0,i.useCallback)(t=>{"Started"===x.current?(x.current="Stopped",d?.error(t)):(0,s.A9)(`WARN.${e}.noTiming.error`)},[d]),C=(0,i.useCallback)(e=>{"Started"===x.current&&d?.abort("duplicated_init_stopwatch_action"),x.current="Started",d?.start(e)},[d]),Z=(0,i.useCallback)(e=>{"NotStarted"===x.current&&(x.current="Started",d?.start(e))},[d]),B=(0,i.useCallback)(t=>{"Started"===x.current?(x.current="Stopped",d?.stop(t)):(0,s.A9)(`WARN.${e}.noTiming.stop`)},[d]);(0,i.useEffect)(()=>()=>{n&&b("unloadOrClientNavigation")},[h]);let M=(0,i.useMemo)(()=>({name:e,isTiming:_,abort:b,addAnnotation:S,addBinaryAnnotation:w,binaryAnnotationOperation:I,addSubspan:j,subspanStart:k,subspanStop:E,getSpans:P,getTraceId:T,updateSubspanName:A,stop:B,error:L,start:C,startOnce:Z}),[_,b,S,w,I,j,k,E,P,T,A,B,L,C,Z]);return(0,v.jsx)(c,{value:M,children:r})},get:d}}},219136:function(e,t,n){n.d(t,{Sx:()=>r,wU:()=>i,zc:()=>s});let i="#E1E1E1",r="#F1F1F1",s="0 0 0 4px rgba(0, 132, 255, .5)"},537701:function(e,t,n){n.d(t,{Z:()=>i});function i(e,t){let n=t?.separateNumbers?/([A-Z]|\d)/g:/([A-Z])/g;return e.replace(n,(e,t)=>"_"+t.toLowerCase())}},902123:function(e,t,n){n.d(t,{Z:()=>a,q:()=>s});var i=n(667294);let r=()=>{let[e,t]=(0,i.useState)(!1),[n,r]=(0,i.useState)(!1),[s,a]=(0,i.useState)(!1);return{active:e,focused:n,hovered:s,onBlur:()=>{r(!1),t(!1)},onFocus:()=>r(!0),onMouseDown:()=>t(!0),onMouseEnter:()=>a(!0),onMouseLeave:()=>{a(!1),t(!1)},onMouseUp:()=>t(!1)}};function s({children:e}){return e(r())}let a=r},523614:function(e,t,n){n.d(t,{A:()=>o,Z:()=>l});var i=n(686659),r=n(667294),s=n(740097),a=n(785893);let o={bubbleOverlay:{backgroundColor:"rgba(0, 0, 0, 0.4)"},hoverOverlay:{backgroundColor:"rgba(0, 0, 0, 0.6)"},lightHoverOverlay:{backgroundColor:"rgba(0, 0, 0, 0.1)"}};function l({backgroundColor:e,children:t,coverImage:n,disableTabIndex:l,height:c,id:d,isHovered:u,onClick:p,onMouseDown:h,onMouseEnter:g,onMouseLeave:x,searchBoxRenderStopwatch:m,url:_,width:f}){(0,r.useEffect)(()=>{(0,i.Z)("BubbleWrapper","/app/www/discover/Bubbles/BubbleWrapper.tsx")},[]);let[y,v]=(0,r.useState)(!1),b=()=>{g?g():v(!0)},S=()=>{x?x():v(!1)},w=u||y,I=w?o.hoverOverlay:o.bubbleOverlay;return(0,a.jsx)(s.Tg,{href:_,onBlur:S,onFocus:b,onMouseDown:h,onMouseEnter:b,onMouseLeave:S,onTap:()=>{p?.(d)},rounding:4,tabIndex:l?-1:void 0,children:(0,a.jsx)(s.zd,{height:c,rounding:4,width:f||"100%",children:n?.url?(0,a.jsxs)(s.Ee,{alt:"",color:e,fit:"cover",naturalHeight:n.height??1,naturalWidth:n.width??1,onLoad:()=>{m?.stop()},role:"presentation",src:n.url,children:[(0,a.jsx)(s.xu,{dangerouslySetInlineStyle:{__style:I},height:"100%",width:"100%"}),"function"==typeof t?t({isHovered:w}):t]}):(0,a.jsx)(s.xu,{dangerouslySetInlineStyle:{__style:{backgroundColor:e}},height:"100%",width:"100%"})})})}},334935:function(e,t,n){n.d(t,{Z:()=>tm});var i=n(686659),r=n(667294),s=n(740097),a=n(99643),o=n(230201),l=n(24246),c=n(893957),d=n(785893);function u({showCancel:e,viewType:t}){(0,r.useEffect)(()=>{(0,i.Z)("LensEntryPoint","/app/common/react/components/Lens/LensEntryPoint.tsx")},[]);let n=(0,l.Z)(),{logContextEvent:u}=(0,o.u)(),{setIsLensModalOpen:p}=(0,a.m)();(0,c.Z)(()=>{u({component:43,element:1304,event_type:120,view_type:t})});let h=(0,r.useCallback)(()=>{p(!0),u({component:43,element:1304,event_type:101})},[p,u]);return(0,d.jsxs)(s.kC,{alignItems:"center",direction:"row",height:"100%",children:[e&&(0,d.jsx)(s.xu,{dangerouslySetInlineStyle:{__style:{borderLeft:"2px solid #cdcdcd",borderRadius:24}},"data-test-id":"lens-vertical-line",height:20}),(0,d.jsx)(s.hU,{accessibilityLabel:n._('Lens', 'searchBox.lens.accessibilityLabel', 'Lens'),icon:"search-by-image",iconColor:"subtle",onClick:h})]})}var p=n(312048),h=n(478300),g=n(661376),x=n(115366),m=n(902123);function _(){(0,r.useEffect)(()=>{(0,i.Z)("LensHistory","/app/common/react/components/Lens/LensHistory.tsx")},[]);let e=(0,l.Z)(),{setHistoryData:t,setImage:n,setIsLensModalOpen:c}=(0,a.m)(),u=(0,p.s0)(),{logContextEvent:h}=(0,o.u)(),[_,f]=(0,r.useState)(!1),{data:y=[],isLoaded:v}=(0,g.Z)({name:"ApiResource",options:{url:"/v3/visual_search/lens/history/",data:{fields:"id,image_urls,image_sizes"}},noCache:!0}),b=v&&y&&y.length>0;(0,r.useEffect)(()=>{!_&&b&&(h({component:15075,element:14560,event_type:120,view_type:119}),f(!0))},[b,h,f,_]),(0,r.useEffect)(()=>{b&&t(y)},[t,y,b]);let S=()=>{n(void 0),c(!1),h({component:15075,element:14560,event_type:101,view_type:119}),u("/lens-search/history")};return y&&0!==y.length?(0,d.jsx)(m.q,{children:({hovered:t,onMouseEnter:n,onMouseLeave:i})=>(0,d.jsx)(s.iP,{onTap:S,children:(0,d.jsxs)(s.xu,{alignContent:"between",dangerouslySetInlineStyle:{__style:{backgroundColor:t?"rgba(0, 0, 0, .1)":void 0}},direction:"row",display:"flex",height:110,onMouseEnter:n,onMouseLeave:i,position:"relative",rounding:4,width:"100%",children:[(0,d.jsx)(s.xu,{marginTop:2,position:"relative",width:112,children:y.slice(0,3).map((e,t)=>e?.id&&t<3&&(0,d.jsx)(x.Z,{card:{url:e.image_urls["236x236"]},fanOut:!1,index:t,rounding:4,size:"SMALL"},e.id))}),(0,d.jsxs)(s.xu,{alignItems:"center",direction:"row",display:"flex",justifyContent:"between",paddingX:2,width:"calc(100% - 112px)",children:[(0,d.jsxs)(s.kC,{alignItems:"stretch",direction:"column",gap:1,justifyContent:"start",children:[(0,d.jsx)(s.qd,{size:"400",children:e._('History', 'lens.history', 'header for the history count')}),(0,d.jsx)(s.xv,{size:"200",children:e._('View previous uploads', 'lens.previous.uploads', 'previously uploaded lens image history ')})]}),(0,d.jsx)(s.JO,{accessibilityLabel:e._('Lens history', 'lens.history.navigation.button', 'Clicking on the button will navigate the user to the Lens History landing page'),color:"default",icon:"arrow-forward"})]})]})})}):null}var f=n(735815),y=n(877762),v=n(236269),b=n(465784),S=n(216975),w=n(667980),I=n(319910),j=n(832274),k=n(257026),E=n(424304),A=n(520803);let P={border:"2px dashed #dadada",borderRadius:"16px",pointerEvents:"none"};function T(){(0,r.useEffect)(()=>{(0,i.Z)("LensModal","/app/common/react/components/Lens/LensModal.tsx")},[]);let e=(0,l.Z)(),t=(0,p.s0)(),{historyData:n,image:u,setHeroImageUrl:g,setImage:x,setImageData:m,setIsLensModalOpen:T}=(0,a.m)(),{path:L}=(0,A.Z)(),{logContextEvent:C}=(0,o.u)(),[Z,B]=(0,r.useState)(347),[M,z]=(0,r.useState)(""),[R,F]=(0,r.useState)(""),[O,D]=(0,r.useState)(null),[N,$]=(0,r.useState)(""),U=(0,r.useRef)(null),G="/lens-search"===L,H="/lens-search/history"===L;(0,c.Z)(()=>{C({component:15075,event_type:120,view_type:119})}),(0,r.useEffect)(()=>{""===M?$(""):F("")},[M]),(0,r.useEffect)(()=>{(G||H)&&O&&!u&&(T(!1),H&&t("/lens-search/"))},[T,t,G,u,O,H]),(0,r.useEffect)(()=>{u&&!G&&(t("/lens-search/"),T(!1))},[t,G,u,T]),(0,r.useEffect)(()=>{n&&n.length>0&&347===Z&&B(Z+110+12)},[n,B,Z]);let q=(0,r.useCallback)(async()=>{if(O)try{let t=await (0,f.Z)(O,m),n=await (0,E.Z)({i18n:e,ideaPinRenamingEnabled:!1,file:t,options:{allowVideo:!1}});if("error"===n.type)F(n.message);else{F(""),x(t);let e=new FormData;e.append("image",t),(0,y.Z)({url:"/upload-image-lens-history/",type:"PUT",data:e})}}catch(e){F((0,v.Z)(e,"message")??"")}},[O,F,x,e,m]),W=()=>{x(void 0),g(void 0)};return(0,r.useEffect)(()=>{O&&q()},[q,O]),(0,d.jsx)(b.ZP,{accessibilityModalLabel:e._('Lens modal', 'lens.modal.accessibilityLabel', 'Modal for Lens Image Search'),align:"start",heading:(0,d.jsxs)(s.kC,{alignItems:"center",justifyContent:"between",children:[(0,d.jsx)(s.qd,{accessibilityLevel:1,size:"600",children:e._('Upload an image to search', 'lens.modal.header', 'Header for Lens Image Search modal')}),(0,d.jsx)(s.hU,{accessibilityLabel:e._('Lens icon', 'lens.entrypoint.icon', 'Icon for lens entrypoint'),bgColor:"white",icon:"cancel",iconColor:"darkGray",onClick:()=>T(!1),size:"md"})]}),isOpen:!0,onDismiss:()=>T(!1),size:"sm",children:(0,d.jsx)(s.xu,{height:Z,marginTop:1,paddingX:6,children:(0,d.jsxs)(s.xu,{height:311,position:"relative",children:[(0,d.jsx)(k.Z,{accept:[...j.xl].join(","),accessibilityLabel:e._('File Upload', 'lens.upload.fileUpload', 'Input where we upload files for Lens image search'),allowMultipleFiles:!1,dropRounding:16,hasError:!!R,id:"lens-photo-upload-input",onChange:e=>{let t=e.target.files?.[0];t&&(C({component:15075,element:14558,event_type:15656,view_type:119}),D(t)),W()},onDrop:t=>{let n=t.dataTransfer.files;C({component:15075,event_type:3501,view_type:119}),n.length>1?F(e._('We can\u2019t search multiple images at once', 'lens.error.multipleImages', 'Error message for uploading multiple images in Lens Image Search')):(F(""),D(t.dataTransfer.files[0])),W()},children:()=>(0,d.jsxs)(s.xu,{alignItems:"center",dangerouslySetInlineStyle:{__style:P},direction:"column",display:"flex",height:"100%",children:[(0,d.jsxs)(s.xu,{alignItems:"center",dangerouslySetInlineStyle:{__style:{marginTop:70}},direction:"column",display:"flex",children:[(0,d.jsx)(s.JO,{accessibilityLabel:e._('Upload photo', 'lens.photo.upload.icon', 'Upload indicator for lens image search'),color:R?"error":"dark",icon:R?"alert":"arrow-circle-up",size:24}),(0,d.jsx)(s.kC,{alignItems:"center",direction:"column",justifyContent:"start",children:(0,d.jsxs)(s.xu,{alignItems:"center",direction:"column",display:"flex",justifyContent:"center",marginTop:4,children:[!!R&&(0,d.jsx)(s.xu,{marginBottom:4,width:320,children:(0,d.jsx)(s.xv,{align:"center",color:"error",children:R})}),(0,d.jsx)(s.xv,{align:"center",inline:!0,children:(0,S.nk)(e._('Drag an image here or {{ chooseFile }}', 'lens.modal.uploadTip.dragImage', 'Upload tip for Lens Image Search. chooseFile: choose a file to upload'),{chooseFile:(0,d.jsx)(s.xv,{inline:!0,underline:!0,children:e._('choose a file', 'lens.modal.uploadTip', 'Upload tip for Lens Image Search')},"lens-choose-file")})})]})})]}),(0,d.jsx)(s.xu,{bottom:!0,dangerouslySetInlineStyle:{__style:{borderTop:"1px solid #cdcdcd"}},paddingY:6,position:"absolute",width:"90%",children:(0,d.jsx)(w.Z,{children:(0,d.jsxs)(s.xu,{position:"relative",zIndex:new s.Ry(10),children:[(0,d.jsx)(s.nv,{ref:U,errorMessage:N,hasError:!!N,id:"scrape-view-website-link",label:e._('Upload from URL', 'lens.url.label', 'Label for url input'),onChange:({value:e})=>{z(e)},placeholder:e._('Paste image link', 'lens.url.textField', 'Placeholder text to enter website url'),size:"lg",type:"url",value:M}),!!M&&(0,d.jsx)(s.xu,{dangerouslySetInlineStyle:{__style:{marginTop:30}},paddingX:2,position:"absolute",right:!0,top:!0,children:(0,d.jsx)(s.hU,{accessibilityLabel:e._('Submit', 'lens.url.submitButton', 'Submit button to scrape images from url'),bgColor:"lightGray",icon:"arrow-forward",iconColor:"darkGray",onClick:()=>(t=>{let n=(0,I.Z)({url:t});C({component:15075,element:14559,event_type:15656,view_type:119}),n?$(""):$(e._('Invalid URL. Try using another link', 'lens.url.invalid', 'Error message for invalid URL in Lens Image Search')),x(void 0),(async()=>{D(await (0,h.Z)(t))})(),t&&((0,h.Z)(t),g(t))})(M),size:"sm"})})]})})})]})}),(0,d.jsx)(s.xu,{marginTop:6,children:(0,d.jsx)(_,{})})]})})})}var L=n(433100),C=n(501010),Z=n(439947);let{Provider:B,get:M}=(0,Z.Z)({name:"autocomplete_render",sampleRate:1}),{Provider:z,get:R}=(0,Z.Z)({name:"search_tab_render",sampleRate:1});var F=n(774838),O=n(917569),D=n(53596),N=n(935059),$=n(59111);function U({gradientPrimaryColor:e,gradientSecondaryColor:t,gradientDirection:n,position:i}){return(0,d.jsx)(s.xu,{bottom:"bottom"===i,dangerouslySetInlineStyle:{__style:{backgroundImage:`linear-gradient(${n}, ${e}, ${t})`,pointerEvents:"none"}},height:16,position:"absolute",rounding:"pill",top:"top"===i,width:"100%",zIndex:new s.Ry(1)})}let G=({term:e})=>(0,d.jsx)(s.xv,{color:"subtle",inline:!0,lineClamp:1,children:e});function H({defaultPlaceholder:e,gradientSecondaryColor:t="#FFF",height:n=48,suggestedSearchTerms:a}){let o;(0,r.useEffect)(()=>{(0,i.Z)("DynamicSearchPlaceholder","/app/packages/search/DynamicSearchPlaceholder.tsx")},[]);let c=(0,l.Z)(),u=a.length<3,p=(0,r.useRef)(null);return(0,d.jsx)(s.xu,{ref:p,alignItems:"center",dangerouslySetInlineStyle:{__style:{pointerEvents:"none"}},"data-test-id":"dynamic-search-placeholder",display:"flex",height:n,overflow:"hidden",position:"relative",children:u?(0,d.jsx)(s.xv,{color:"subtle",inline:!0,children:e}):(0,d.jsxs)(r.Fragment,{children:[(0,d.jsx)(U,{gradientDirection:"to top",gradientPrimaryColor:"rgba(255, 255, 255, 0)",gradientSecondaryColor:t,position:"top"}),(0,d.jsx)(U,{gradientDirection:"to bottom",gradientPrimaryColor:"rgba(255, 255, 255, 0)",gradientSecondaryColor:t,position:"bottom"}),(0,d.jsxs)(s.kC,{alignItems:"stretch",height:18,justifyContent:"start",children:[(0,d.jsx)(s.xv,{color:"subtle",inline:!0,overflow:"noWrap",children:c._('Search for', 'searchBar.placeholder.dynamicText', 'Placeholder in search input. This text is followed by a set of animated search phrases like "Search for aesthetic art"')}),(0,d.jsx)($.Z,{unsafeCSS:`
@keyframes slide-3-terms-loop {
  0%, 21.74% {
    transform: translateY(0%);
  }
  33.33%, 55.07% {
      transform: translateY(-25%);
  }
  66.66%, 88.4% {
      transform: translateY(-50%);
  }
  100% {
      transform: translateY(-75%);
  }
}
@keyframes slide-4-terms-loop {
  0%,16.3% {
    transform: translateY(0%);
  }
  25%,41.3%{
    transform: translateY(-20%);
  }
  50%,66.3%{
    transform: translateY(-40%);
  }
  75%,91.3%{
    transform: translateY(-60%);
  }
  100% {
    transform: translateY(-80%);
  }
}
@keyframes slide-5-terms-loop {
  0%, 13.04% {
    transform: translateY(0%);
  }
  20%,33.04%{
    transform: translateY(-16.66%);
  }
  40%,53.04%{
    transform: translateY(-33.33%);
  }
  60%,73.04%{
    transform: translateY(-49.98%);
  }
  80%,93.04%{
    transform: translateY(-66.64%);
  }
  100% {
    transform: translateY(-83.3%);
  }
}
`}),(0,d.jsx)(s.xu,{children:(0,d.jsxs)(s.xu,{dangerouslySetInlineStyle:(o=a.length,{__style:{animation:`slide-${o}-terms-loop ${2.3*(o+1)}s ease-out infinite forwards`}}),display:"inlineBlock",marginStart:1,children:[a.map(e=>(0,d.jsx)(s.xu,{marginBottom:7,children:(0,d.jsx)(G,{term:e})},e)),(0,d.jsx)(s.xu,{marginBottom:7,children:(0,d.jsx)(G,{term:a[0]??""})})]})})]})]})})}var q=n(137679);function W(){(0,r.useEffect)(()=>{(0,i.Z)("InlineACSuggestion","/app/packages/search/InlineACSuggestion.tsx")},[]);let{displayedQuery:e,inlineACSuggestion:t,logInlineSuggestionView:n}=(0,q.$)();return(0,c.Z)(()=>{n()}),(0,d.jsxs)(s.xu,{dangerouslySetInlineStyle:{__style:{whiteSpace:"pre-wrap"}},children:[(0,d.jsx)("span",{style:{visibility:"hidden"},children:(0,d.jsx)(s.xv,{color:"disabled",inline:!0,children:e})}),(0,d.jsx)(s.xv,{color:"subtle",inline:!0,children:t.slice(e.length)})]})}var V=n(722157),X=n(219136),K=n(372164),Y=n(275894);function J({disabled:e=!1,name:t}){(0,r.useEffect)(()=>{(0,i.Z)("SearchInput","/app/packages/search/SearchInput.tsx")},[]);let n=(0,l.Z)(),a=(0,r.useRef)(null),o=(0,r.useRef)(void 0),{isAuth:u}=(0,N.Z)(),h=(0,p.TH)(),g=(0,s.JZ)(),{delayedSearchBoxOpen:x,displayedQuery:m,handleInputBlur:_,handleInputChange:f,handleInputClick:y,handleInputFocus:v,handleKeyDown:b,handleKeyUp:S,suggestionsFocusIndex:w,suggestionGroups:I,inlineACSuggestion:j,isInTypeaheadSession:k,handleTypedSearchSubmit:E,searchBoxPlaceholder:A,searchBoxHovered:P,setVoiceSearchPlaceholder:T,suggestedSearchTerms:L,voiceSearchPlaceholder:C}=(0,q.$)(),Z=(0,K.zj)({suggestionsFocusIndex:w,suggestionGroups:I}),{isEligiblePageTypeForDynamicSearchPlaceholder:B}=(0,V.b)(h);(0,r.useEffect)(()=>{C&&o.current&&(o.current.pathname!==h.pathname||o.current.search!==h.search)&&T(Y.K.NULL),o.current=h},[h,C,T]),(0,c.Z)(()=>{a.current&&E&&a.current.addEventListener("searchTrigger",E)}),(0,r.useEffect)(()=>{a.current&&(document.activeElement===a.current!==k?k?a.current.focus():a.current.blur():T(Y.K.NULL))},[k,T]),(0,c.Z)(()=>{a.current&&new URLSearchParams(window.location.search).get("search_box_open")&&x()});let M=!g&&!u&&B&&!m,z=A||n._('Search', 'searchBox.searchInput.placeholder', 'placeholder text for the search box');return(0,d.jsxs)(s.xu,{flex:"grow",height:"100%",children:[(0,d.jsx)($.Z,{unsafeCSS:`input::placeholder{ color: #6E6E6E${M?"; opacity: 0":""}}`}),(0,d.jsx)("input",{ref:a,"aria-activedescendant":Z,"aria-autocomplete":"list","aria-controls":"SuggestionsMenu","aria-describedby":"searchBoxAccessibleText","aria-expanded":k,"aria-label":n._('Search', 'searchBox.searchInput.placeholder', 'placeholder text for the search box'),autoCapitalize:"off",autoComplete:"off",autoCorrect:"off","data-gestalt-valid-html":"SearchField","data-test-id":"search-box-input",disabled:e,name:t,onBlur:_,onChange:f,onClick:y,onFocus:v,onKeyDown:b,onKeyUp:S,placeholder:z,role:"combobox",style:{backgroundColor:"transparent",border:"none",color:"#333",fontFamily:D.Z,fontSize:16,fontWeight:"normal",height:"100%",outline:"none",padding:"0",width:"100%"},type:"text",value:m}),!!j&&(0,d.jsx)(s.xu,{dangerouslySetInlineStyle:{__style:{pointerEvents:"none",top:13}},position:"absolute",top:!0,width:"85%",children:(0,d.jsx)(W,{})}),M&&(0,d.jsx)(s.xu,{dangerouslySetInlineStyle:{__style:{pointerEvents:"none"}},position:"absolute",top:!0,width:"85%",children:(0,d.jsx)(H,{defaultPlaceholder:z,gradientSecondaryColor:P?X.wU:X.Sx,suggestedSearchTerms:L})}),(0,d.jsx)(s.xu,{display:"none",id:"searchBoxAccessibleText",children:n._(`When autocomplete results are available use up and down arrows to
                review and enter to select. Touch device users, explore by touch or
                with swipe gestures.`, 'searchBox.searchInput.accessibleText', 'Accessible text for search input')})]})}var Q=n(818282),ee=n(405897),et=n(477738),en=n(510755);function ei({contentTypes:e,contentTypesAnchor:t,handleSelectFilter:n,onDismiss:a}){return(0,r.useEffect)(()=>{(0,i.Z)("ContentFilterList","/app/www/discover/SearchBox/ContentFilterList.tsx")},[]),(0,d.jsx)(s.Lt,{anchor:t,disableMobileUI:!0,id:"ContentFilterList",idealDirection:"down",isWithinFixedContainer:!0,onDismiss:a,zIndex:new s.Ry(en.fe),children:e.map((e,t)=>(0,d.jsx)(s.Lt.Item,{dataTestId:"search-filter-"+e.dataId,onSelect:()=>n(t),option:{value:e.text,label:e.text},children:(0,d.jsx)(s.xv,{weight:[et.lw.PINS,et.lw.PINS_MINE].includes(e.scope)?"bold":"normal",children:e.text})},e.text))})}var er=n(973625),es=n(500602);let ea=function({currentlySelectedFilter:e,currentQuery:t,handleContentTypeFilterHover:n,handleScopeChange:i}){let{logContextEvent:a}=(0,o.u)(),c=(0,l.Z)(),u=function(e){let t=[{scope:et.lw.PINS,text:e._('All Pins', 'All Pins label for content type filters on search bar', 'All Pins label for content type filters on search bar'),dataId:"all-pins"},{scope:et.lw.PINS_MINE,text:e._('Your Pins', 'Your Pins label for content type filters on search bar', 'Your Pins label for content type filters on search bar'),dataId:"your-pins"}],n=t.findIndex(e=>e.scope===et.lw.PINS_MINE);return t.push(t.splice(n,1)[0]),t}(c),h=(0,r.useRef)(null),g=(0,p.s0)(),{enabled:x}=(0,er.Z)(),[m,_]=(0,r.useState)(e||u[0].scope),[f,y]=(0,r.useState)(!1),[v,b]=(0,r.useState)(!1);(0,r.useEffect)(()=>{_(e)},[e]);let S=(u[m?u.findIndex(e=>e.scope===m):0]||u[0]).text,w=(0,d.jsx)(s.xu,{ref:h,dangerouslySetInlineStyle:{__style:{borderRadius:"0 4px 4px 0",height:Q.XI}},"data-test-id":"search-filter",overflow:"hidden",children:(0,d.jsxs)(s.xu,{alignItems:"center",display:"flex",height:"100%",justifyContent:"center",paddingX:4,children:[(0,d.jsx)(s.xv,{inline:!0,size:"200",weight:"bold",children:S}),(0,d.jsx)(s.xu,{marginStart:2,children:(0,d.jsx)(s.JO,{accessibilityLabel:c._('Dropdown', ' - ', ' -- '),color:"default",icon:"arrow-down",inline:!0,size:12})})]})});return(0,d.jsxs)(s.xu,{alignItems:"center",dangerouslySetInlineStyle:{__style:{backgroundColor:v?"rgba(0, 0, 0, 0.06)":void 0}},display:"flex",flex:"none",height:Q.XI,marginStart:2,position:"relative",rounding:x?es.Qq:6,children:[(0,d.jsx)(s.iP,{fullHeight:!0,fullWidth:!1,onMouseEnter:()=>void(b(!0),n&&n(!0)),onMouseLeave:()=>void(b(!1),n&&n(!1)),onTap:({event:e})=>{e&&(e.preventDefault(),e.stopPropagation()),y(!f),a({event_type:101,component:215,aux_data:{entered_query:t}})},rounding:6,children:w}),f&&(0,d.jsx)(ei,{contentTypes:u,contentTypesAnchor:h.current,handleSelectFilter:e=>{let n=u[e].scope;_(n),y(!1),a({event_type:101,component:215,element:(e=>{switch(e){case et.lw.PINS:return 220;case et.lw.PINS_MINE:return 223;case et.lw.PINS_VIDEO:return 11399;case et.lw.BOARDS:return 221;case et.lw.USERS:return 222;default:return null}})(n),aux_data:{entered_query:t}}),i(n),t&&g(`/search/${n}/?q=${encodeURIComponent(t)}&rs=${ee.i.FILTER}`)},onDismiss:()=>y(!1)})]})};var eo=n(213491),el=n(57887);let ec={recentSaves:[],recentViews:[]};function ed(e,t){if(e=e||ec,"FETCH_COMPLETE"!==t.type)return e;{let{options:n={},resource:i}=t.payload,{data:r}=t.payload.response.resource_response;if("ApiResource"===i&&"/v3/users/me/recent/engaged/pin/stories/"===n.url&&r){let t=r.find(e=>"user_recently_viewed_pins"===e.story_type),n=r.find(e=>"user_recently_saved_pins"===e.story_type),i=t?.objects.map(({description:e,id:t,images:n},i)=>({label:e,images:n,resultIndex:i,type:"recent_view",url:`/pin/${t}`}))||[],s=n?.objects.map(({description:e,id:t,images:n},i)=>({label:e,images:n,resultIndex:i,type:"recent_save",url:`/pin/${t}`}))||[];return{...e,recentSaves:s,recentViews:i}}return e}}let{Provider:eu,get:ep}=(0,eo.Z)("SearchBox");function eh({children:e}){let[t,n]=(0,r.useReducer)(ed,ec),i=(0,r.useCallback)(e=>{n({type:"FETCH_COMPLETE",payload:e})},[]);(0,el.Z8)("ApiResource",i);let s=(0,r.useMemo)(()=>({state:t}),[t]);return(0,d.jsx)(eu,{value:s,children:e})}var eg=n(890678),ex=n(739405);function em({autocompleteRequestSurface:e}){let t=(0,ex.HG)(),n=(0,N.Z)();return(0,eg.Z)(n.isAuth?{name:"AdvancedTypeaheadResource",options:{term:"",pin_scope:et.lw.PINS,autocomplete_request_surface:e},noCache:!0}:null),(0,eg.Z)(t?{name:"SearchTabResource"}:null),null}var e_=n(716769),ef=n(711072),ey=n(753806),ev=n(112658),eb=n(470205),eS=n(79271);let ew=({children:e,impressionTrackerProps:t})=>((0,r.useEffect)(()=>{(0,i.Z)("MaybeImpressionTracker","/app/packages/impression-logging/MaybeImpressionTracker.tsx")},[]),t?(0,d.jsx)(eS.Fw,{...t,children:e}):e({impressionTrackerRef:null}));var eI=n(825605),ej=n(748336);function ek({onLoad:e,suggestion:t}){(0,r.useEffect)(()=>{(0,i.Z)("AutocompleteUpsellSuggestions","/app/www/discover/SearchBox/AutocompleteUpsellSuggestions.tsx")},[]);let n=(0,ej.Z)({url:t.action_button_uri});return(0,r.useEffect)(()=>{e()},[]),(0,d.jsxs)(s.xu,{padding:10,children:[(0,d.jsx)(s.xu,{dangerouslySetInlineStyle:{__style:{color:"#004b91",fontSize:"28px",WebkitFontSmoothing:"antialiased"}},marginBottom:6,children:t.description}),(0,d.jsx)(s.Tg,{href:t.action_button_uri,rel:n?"nofollow":"none",rounding:"pill",children:(0,d.jsx)(s.xu,{color:"infoBase",display:"inlineBlock",padding:3,rounding:"pill",children:(0,d.jsx)(s.xv,{color:"inverse",weight:"bold",children:t.action_button_text})})})]})}var eE=n(98557),eA=n(55424),eP=n(261926);let eT=(0,r.lazy)(()=>n.e("97008").then(n.bind(n,221340)));function eL({experiences:e,index:t,focusedIndex:n,onSuggestionMouseEnter:i,onSuggestionMouseLeave:a,onLoad:o,query:l,suggestion:c}){let u=(0,eA.Z)(c),{handleSuggestionSelect:p,handleInclusiveProductFilterClick:h,getSuggestionImpressionOptions:g}=(0,q.$)();return(0,r.useEffect)(()=>{c.image||o()},[]),(0,d.jsx)(ey.M8,{experiences:e,placementId:1000315,searchTerm:l,suggestions:[c],children:({searchDelightConfig:e})=>(0,d.jsx)(ew,{impressionTrackerProps:g({index:t,groupIndex:t,suggestion:c,loggingId:c.id}),children:({impressionTrackerRef:r})=>(0,d.jsxs)(s.xu,{ref:r,marginBottom:1,marginEnd:-3,marginStart:-3,children:[(0,d.jsx)(eE.J,{id:(0,K.Gp)(0,t),isHovered:n===t,onClick:()=>{p({suggestion:c,index:t})},onMouseEnter:()=>{i(t)},onMouseLeave:()=>{a()},url:(0,K.Ek)({suggestion:c,query:l}),children:(0,d.jsx)(s.kC,{alignItems:"center",justifyContent:"start",children:(0,d.jsx)(s.xu,{flex:"grow",children:(0,d.jsx)(eE.q,{highlightMatch:!0,imageUrl:c.image,label:c.label,onLoad:o,query:l,rounding:2,searchDelightConfig:e,subLabel:c.subLabel,type:c.type})})})}),!!u&&u!==eP.ti.BODY&&h&&(0,d.jsx)(s.kC,{alignItems:"center",justifyContent:"start",overflow:"hidden",children:(0,d.jsx)(eb.Z,{name:"SafeSuspense_BlendedTypeaheadSuggestion_InclusiveFilters",children:(0,d.jsx)(eI.Z,{children:(0,d.jsx)(eT,{filters:{[u]:c.modified_filter_eligibility?.[u]?.filter_options},moduleType:eP.CT.SEARCH_AUTOCOMPLETE,onClickApplyFilters:e=>h(c,t,e),query:l,viewParameter:103,viewType:Q.Ie})})})})]})})})}let eC=({index:e,focusedIndex:t,onSuggestionMouseEnter:n,onSuggestionMouseLeave:i,onLoad:r,suggestion:a})=>{let{handleSuggestionSelect:o,getSuggestionImpressionOptions:l}=(0,q.$)();return(0,d.jsx)(ew,{impressionTrackerProps:l({index:e,groupIndex:e,suggestion:a,loggingId:a.id}),children:({impressionTrackerRef:l})=>(0,d.jsx)(s.xu,{ref:l,marginBottom:1,marginEnd:-3,marginStart:-3,children:(0,d.jsx)(eE.J,{id:(0,K.Gp)(0,e),isHovered:t===e,onClick:()=>{o({suggestion:a,index:e})},onMouseEnter:()=>{n(e)},onMouseLeave:()=>{i()},url:a.url,children:(0,d.jsx)(eE.q,{imageUrl:a.image,isVerifiedMerchant:a.is_verified_merchant,label:a.label,onLoad:r,rounding:"circle",subLabel:a.subLabel,verified:a.verified})})},`${a.type}-${a.label}-${a.subLabel||""}`)})};function eZ({experiences:e,suggestions:t,focusedIndex:n,query:s,onSuggestionMouseEnter:a,onSuggestionMouseLeave:o}){(0,r.useEffect)(()=>{(0,i.Z)("BlendedTypeaheadSuggestion","/app/www/discover/SearchBox/BlendedTypeaheadSuggestion.tsx")},[]);let l=M(),c=e=>"image"in e&&e.image,u=t.some(c),p=()=>{l?.stop()};return t.map((t,i)=>{let r=!u||c(t);switch(t.type){case"autocompleteupsell":return(0,d.jsx)(ek,{onLoad:r?p:()=>{},suggestion:t},`search-suggestion-${t.type}-${t.id}`);case"query":case"recent_pin_searches":return(0,d.jsx)(eL,{experiences:e,focusedIndex:n,index:i,onLoad:r?p:()=>{},onSuggestionMouseEnter:a,onSuggestionMouseLeave:o,query:s,suggestion:t},`search-suggestion-${t.type}-${t.id}`);case"user":return(0,d.jsx)(eC,{focusedIndex:n,index:i,onLoad:r?p:()=>{},onSuggestionMouseEnter:a,onSuggestionMouseLeave:o,suggestion:t},`search-suggestion-${t.type}-${t.id}`);default:return null}})}var eB=n(535486),eM=n(47755),ez=n(997526),eR=n(806513),eF=n(574991),eO=n(523614),eD=n(609370),eN=n(720517);function e$({contextLogData:e,dominantColor:t,groupIndex:n,height:a,icon:o,images:c,isDarkRep:u=!1,isHovered:p,title:h,onMouseEnter:g,onMouseLeave:x,onClick:m,searchBoxRenderStopwatch:_,suggestion:f,showRemoveButton:y=!1,slotIndex:v,url:b,width:S}){(0,r.useEffect)(()=>{(0,i.Z)("SearchInFeedRep","/app/common/react/components/discover/stories/SearchInFeedRep.tsx")},[]);let w=(0,l.Z)(),{autocompleteRequestSurface:I,getSuggestionImpressionOptions:j,isSyop:k}=(0,q.$)(),{group:E,anyEnabled:A}=(0,eD.Z)({isSyop:k}),P=(0,eN.Z)(I),T=E.includes("vertical"),L=a||80,C=c&&c[0]&&c[0]["236x"]?.url||"",Z=!!o&&(0,eF.Z)(o),B=!!S&&S<160||!!a&&a<60,M=B&&!A?"200":"300",z=A?void 0:"bold",R=(B||A)&&2||3,F=B&&2||A&&3||4,O=S?S-L:eR.yF-80,D=B?3:4,N=B?2:3,$=()=>{_?.stop()},U=async e=>{await (0,eM.Z)({url:"/v3/search/recent/",method:"DELETE",data:{query:e}}),P()};return(0,d.jsx)(ew,{impressionTrackerProps:j({index:v,additionalAuxData:e,groupIndex:n,suggestion:f,loggingId:f.id}),children:({impressionTrackerRef:e})=>(0,d.jsx)(s.xu,{ref:e,"data-test-id":y?"recent-query":void 0,height:L,width:S||"100%",children:(0,d.jsx)(s.zd,{rounding:D,wash:!u&&!T,children:(0,d.jsx)(s.xu,{dangerouslySetInlineStyle:A?void 0:{__style:u&&{backgroundColor:p?ez.t07:ez.d9H}||p&&eO.A.lightHoverOverlay||{}},children:(0,d.jsx)(eE.J,{isHovered:p,onBlur:()=>{},onClick:m,onFocus:g,onMouseEnter:g,onMouseLeave:x,rounding:D,url:b,children:(0,d.jsxs)(s.kC,{direction:"row",children:[(0,d.jsx)(s.xu,{"data-test-id":"search-suggestion-image-container",flex:"none",height:L,padding:A?1:void 0,width:L,children:(0,d.jsx)(s.zd,{height:"100%",rounding:A?N:void 0,wash:!0,width:"100%",children:(0,d.jsx)(s.Ee,{alt:"",color:t,fit:"cover",naturalHeight:1,naturalWidth:1,onLoad:$,role:"presentation",src:C})})}),(0,d.jsxs)(s.xu,{alignItems:"center",display:"flex",flex:"grow",maxHeight:L,maxWidth:A?void 0:O,padding:F,children:[Z&&(0,d.jsx)(s.xu,{alignItems:"center",display:"flex",flex:"none",marginEnd:2,children:(0,d.jsx)(s.JO,{accessibilityLabel:"",icon:Z,inline:!0,size:14})}),(0,d.jsx)(s.xe,{color:u?"light":void 0,dataTestId:"search-suggestion-text",lineClamp:R,size:M,weight:z,children:h})]}),y&&(0,d.jsx)(s.xu,{dangerouslySetInlineStyle:{__style:{visibility:p?"visible":"hidden"}},"data-test-id":"clear-recent-queries",display:"flex",flex:"none",marginEnd:2,marginStart:-1,children:(0,d.jsx)(s.hU,{accessibilityLabel:w._('Remove recent search', 'Remove recent search icon in search autocomplete', 'Remove recent search icon'),bgColor:"white",focusColor:"darkBackground",icon:"cancel",iconColor:"darkGray",onClick:({event:e})=>{e.stopPropagation(),e.preventDefault(),U(h)},padding:2,size:"sm"})})]})})})})})})}var eU=n(59355),eG=n(681698),eH=n(319226),eq=n(696749),eW=n(69841);function eV({board:e,height:t,isHovered:n,searchBoxRenderStopwatch:s,slotIndex:a,storyId:o,storyType:l,viewParameter:c,viewType:u,width:p,...h}){(0,r.useEffect)(()=>{(0,i.Z)("EditorialBoardBubble","/app/www/discover/Bubbles/EditorialBoardBubble.tsx")},[]);let{id:g,name:x,image_cover_hd_url:m,owner:_,url:f}=e,y=(0,eq.Z)(x||"",{});return x&&g&&f?(0,d.jsx)(eW.u,{auxData:{grid_index:a.toString(),board_id:g,story_type:l,story_id:o},loggingId:g,objectIdStr:g,slotIndex:a,viewParameter:c||3467,viewType:u,children:({impressionTrackerRef:e})=>(0,d.jsx)(eY,{coverImage:{url:m},creator:_,formattedTitle:y,height:t,id:g,impressionTrackerRef:e,inheritedIsHovered:n,searchBoxRenderStopwatch:s,url:f,width:p,...h})}):null}var eX=n(834322);function eK({component:e,height:t,isHovered:n,searchBoxRenderStopwatch:s,slotIndex:a,storyId:o,storyType:l,todayArticle:c,viewParameter:u,viewType:p,width:h,...g}){(0,r.useEffect)(()=>{(0,i.Z)("TodayArticleBubble","/app/www/discover/Bubbles/TodayArticleBubble.tsx")},[]);let{id:x,title:m,image_urls:_,article_creator_user:f,feed_source:y,is_product_pin_feed:v}=c,b=_&&_.length>0?{url:_[0]}:void 0,S=(0,eq.Z)(m||"",{});if(!m||!x)return null;let w=(0,eX.T7)(y??0,v??!1,m,x);return(0,d.jsx)(eW.Y4,{auxData:{grid_index:a.toString(),today_article_id:x,story_type:l,story_id:o},component:e,loggingId:x,objectIdStr:x,slotIndex:a,viewParameter:u||3467,viewType:p,children:({impressionTrackerRef:e})=>(0,d.jsx)(eY,{coverImage:b,creator:f,formattedTitle:S,height:t,id:x,impressionTrackerRef:e,inheritedIsHovered:n,searchBoxRenderStopwatch:s,url:w,width:h,...g})})}let eY=({coverImage:e,creator:t,formattedTitle:n,height:a,id:o,impressionTrackerRef:l,inheritedIsHovered:c,onClick:u,onMouseDown:p,onMouseEnter:h,onMouseLeave:g,searchBoxRenderStopwatch:x,url:m,width:_})=>{(0,r.useEffect)(()=>{(0,i.Z)("TatSpBubble","/app/www/discover/Bubbles/TatSpBubble.tsx")},[]);let f=t?.avatar_color_index;return(0,d.jsx)(eO.Z,{ref:l,backgroundColor:"gray",coverImage:e,disableTabIndex:!0,height:a,id:o,isHovered:c,onClick:u,onMouseDown:p,onMouseEnter:h,onMouseLeave:g,searchBoxRenderStopwatch:x,url:m,width:_,children:(0,d.jsx)(s.xu,{ref:l,alignItems:"end",display:"flex",height:a,justifyContent:"center",padding:3,position:"absolute",top:!0,width:_||"100%",children:(0,d.jsxs)(s.kC,{alignItems:"stretch",direction:"column",justifyContent:"start",children:[a>200?(0,d.jsx)(s.qd,{align:"center",color:"light","data-test-id":"sp-bubble-title",size:"600",children:n}):(0,d.jsx)(s.xv,{align:"center",color:"light","data-test-id":"sp-bubble-subtitle",weight:"bold",children:n}),t&&t.image_small_url&&t.full_name&&(0,d.jsxs)(s.xu,{alignItems:"center","data-test-id":"sp-bubble-creator",display:"flex",justifyContent:"center",marginTop:4,children:[(0,d.jsx)(s.xu,{marginEnd:2,children:(0,d.jsx)(eH.qE,{color:f,name:t.full_name,outline:!0,size:"xs",src:t.image_small_url})}),(0,d.jsx)(s.xv,{color:"light",size:"100",children:t.full_name})]})]})})})};function eJ(e){(0,r.useEffect)(()=>{(0,i.Z)("TatSpBubble","/app/www/discover/Bubbles/TatSpBubble.tsx")},[]);let{bubble:t}=e;return"board"===t.type?(0,d.jsx)(eV,{...e,board:t}):(0,d.jsx)(eK,{...e,todayArticle:t})}let eQ=.75*eR.yF,e0=1.5*eR.yF,e1=1.5*eR.yF;function e3({children:e,prototypeSLP:t,containerWidth:n,repType:a="default"}){return((0,r.useEffect)(()=>{(0,i.Z)("SuggestionsGrid","/app/www/discover/SearchBox/SuggestionsGrid.tsx")},[]),t)?(0,d.jsx)(s.xu,{dangerouslySetInlineStyle:{__style:{display:"grid",gridTemplateColumns:function(e){switch(e){case"sm":return"repeat(1, 1fr)";case"md":return"repeat(2, 1fr)";case"lg":return"repeat(4, 1fr)";default:return`repeat(auto-fit, minmax(${e1}px, 1fr))`}}(n<620?"sm":n<1164?"md":n<1532?"lg":"xxl"),gap:8}},children:e({width:void 0,height:"trending"===a?72:88})}):(0,d.jsx)(s.kC,{alignItems:"stretch",direction:"row",gap:2,justifyContent:"start",wrap:!0,children:e(function({containerWidth:e}){let t,n=4,i=t=>e?(e-(4*Q.r5*2+8*(t-1)))/t:eR.yF;for(t=i(4);t<eQ&&n>1;)n-=1,t=i(n);for(;t>e0;)n+=1,t=i(n);let r=Math.max(60,t/2.6);return{width:t,height:r}}({containerWidth:n}))})}function e6({title:e,action:t,prototypeSLP:n}){return(0,d.jsxs)(s.xu,{alignItems:"center","data-test-id":"suggestion-group-heading",display:"flex",justifyContent:"between",marginEnd:2,children:[n?(0,d.jsx)(s.xu,{marginEnd:1,paddingX:1,children:(0,d.jsx)(s.X6,{lineClamp:1,size:"400",children:e})}):(0,d.jsx)(s.X6,{lineClamp:1,size:"300",children:e}),n&&t&&(0,d.jsx)(s.kC.Item,{flexBasis:"shrink",children:(0,d.jsx)(s.xu,{dangerouslySetInlineStyle:{__style:{top:2}},position:"relative",children:(0,d.jsx)(s.st,{onMouseEnter:t.onFocus,onMouseLeave:t.onBlur,children:(0,d.jsx)(s.iP,{onBlur:t.onBlur,onFocus:t.onFocus,onTap:t.onClick,children:(0,d.jsx)(s.xv,{color:"subtle",children:(0,d.jsx)(s.xu,{dangerouslySetInlineStyle:{__style:{lineHeight:1}},children:t.text})})})})})})]})}let e2=({handleRemove:e,id:t,isHovered:n,label:i,onClick:r,onMouseEnter:a,onMouseLeave:o,removeA11yText:l,url:c})=>(0,d.jsx)(s.xu,{"aria-selected":n?"true":"false","data-test-id":"search-suggestion",id:t,marginBottom:2,marginEnd:2,role:"option",children:(0,d.jsx)(s.Tg,{accessibilityLabel:i,href:c,onMouseEnter:a,onMouseLeave:o,onTap:({event:e,dangerouslyDisableOnNavigation:t})=>{e.metaKey||e.ctrlKey||(t(),e.preventDefault(),r())},rounding:"pill",children:(0,d.jsxs)(s.xu,{alignItems:"center",color:n?"darkWash":"secondary",dangerouslySetInlineStyle:{__style:{whiteSpace:"nowrap"}},display:"flex",paddingX:3,paddingY:1,position:"relative",rounding:"pill",children:[(0,d.jsx)(s.xv,{align:"center",children:i}),(0,d.jsx)(s.xu,{dangerouslySetInlineStyle:{__style:{paddingTop:"2px"}},"data-test-id":"clear-recent-queries",marginStart:2,children:(0,d.jsx)(s.hU,{accessibilityLabel:l??"",icon:"cancel",iconColor:"darkGray",onClick:({event:t})=>{t.stopPropagation(),t.preventDefault(),e?.(i)},size:"xs"})})]})})}),e5=({id:e,isHovered:t,onClick:n,onMouseEnter:i,onMouseLeave:a,showSeeMoreOverlay:o,suggestion:c,trackClick:u,url:p})=>{let h=(0,l.Z)();return(0,d.jsx)(s.xu,{"aria-selected":t?"true":"false","data-test-id":"search-suggestion",id:e,marginBottom:2,paddingX:1,role:"option",children:(0,d.jsx)(s.Tg,{href:p||c.url,onMouseEnter:i,onMouseLeave:a,onTap:({event:e,dangerouslyDisableOnNavigation:t})=>{t(),u(),e.metaKey||e.ctrlKey||p||(e.preventDefault(),n())},rounding:3,tabIndex:-1,children:(0,d.jsxs)(s.zd,{height:Q.YO,rounding:3,wash:t,width:Q.Gh,children:[c.images["236x"]?.url&&(0,d.jsx)(s.Ee,{alt:c.label,fit:"cover",naturalHeight:c.images["236x"]?.height??1,naturalWidth:c.images["236x"]?.width??1,src:c.images["236x"].url}),o&&(0,d.jsxs)(r.Fragment,{children:[(0,d.jsx)(s.xu,{dangerouslySetInlineStyle:Q.H2,height:Q.YO,left:!0,position:"absolute",top:!0,width:Q.Gh}),(0,d.jsx)(s.xu,{alignItems:"center",display:"flex",height:Q.YO,justifyContent:"center",padding:3,position:"absolute",top:!0,width:Q.Gh,children:(0,d.jsx)(s.xv,{align:"center",color:"inverse",dataTestId:"see-more-suggestions-overlay",weight:"bold",children:h._('See More', 'searchBox.suggestionGroups.recentPinRep.seeMoreText', 'Text inviting users to see more of the same type of Pins')})})]})]})})})},e7=({componentType:e,focusedIndex:t,groupIndex:n,keyPrefix:i,onSuggestionMouseEnter:r,onSuggestionMouseLeave:a,seeMoreUrl:l,suggestions:c,title:u})=>{let{logContextEvent:p}=(0,o.u)(),{handleSuggestionSelect:h}=(0,q.$)();return(0,d.jsxs)(s.kC,{dataTestId:`${i}_section`,direction:"column",gap:Q.Lo,children:[(0,d.jsx)(s.kC,{width:"100%",children:(0,d.jsx)(e6,{title:u})}),(0,d.jsx)(s.kC,{alignItems:"stretch",justifyContent:"start",width:"100%",wrap:!0,children:c.map((s,o)=>{let u=o===Q.TD-1&&c.length===Q.TD;return(0,d.jsx)(e5,{id:(0,K.Gp)(n,o),isHovered:t===o,onClick:()=>{h({suggestion:s,index:o})},onMouseEnter:()=>{r(o)},onMouseLeave:()=>{a()},showSeeMoreOverlay:u,suggestion:s,trackClick:()=>{p({event_type:101,component:e,element:u?179:12374,view_type:Q.Ie,view_parameter:103})},url:u?l:s.url},`${i}-${o}`)})})]})};function e4({focusedIndex:e,groupIndex:t,onSuggestionMouseEnter:n,onSuggestionMouseLeave:s,suggestions:a}){(0,r.useEffect)(()=>{(0,i.Z)("SuggestionGroups","/app/www/discover/SearchBox/SuggestionGroups.tsx")},[]);let o=(0,l.Z)();return(0,eU.Q)({component:13844,view_parameter:103,view_type:Q.Ie}),(0,d.jsx)(e7,{componentType:13844,focusedIndex:e,groupIndex:t,keyPrefix:"recent_save",onSuggestionMouseEnter:n,onSuggestionMouseLeave:s,seeMoreUrl:"/me/pins/",suggestions:a,title:o._('Recently saved', 'searchBox.recentSavedSuggestions.heading', 'Recently saved Pins heading in search autocomplete')})}function e8({suggestion:e,groupIndex:t,index:n,focusedIndex:i,onSuggestionMouseEnter:r,onSuggestionMouseLeave:a}){let{handleSuggestionSelect:o,getSuggestionImpressionOptions:c,autocompleteRequestSurface:u}=(0,q.$)(),p=(0,eN.Z)(u),h=(0,l.Z)(),g=async e=>{await (0,eG.Z)({url:"/v3/search/recent/",method:"DELETE",data:{query:e}}),p()},x=h._('Remove', 'Remove recent search in search typeahead suggestion', 'Remove recent search in search typeahead suggestion');return(0,d.jsx)(ew,{impressionTrackerProps:c({index:n,groupIndex:t,suggestion:e,loggingId:e.id}),children:({impressionTrackerRef:l})=>(0,d.jsx)(s.xu,{ref:l,"data-test-id":"recent-query",children:(0,d.jsx)(e2,{handleRemove:g,id:(0,K.Gp)(t,n),isHovered:i===n,label:e.label,onClick:()=>{o({suggestion:e,index:n})},onMouseEnter:()=>{r(n)},onMouseLeave:()=>{a()},removeA11yText:x,url:(0,K.Ek)({suggestion:e,query:""})})},`${e.type}-${e.label}`)})}function e9({containerWidth:e,focusedIndex:t,groupIndex:n,onSuggestionMouseEnter:a,onSuggestionMouseLeave:o,searchBoxRenderStopwatch:c,suggestions:u}){(0,r.useEffect)(()=>{(0,i.Z)("SuggestionGroups","/app/www/discover/SearchBox/SuggestionGroups.tsx")},[]);let p=(0,l.Z)(),{isSyop:h}=(0,q.$)(),{anyEnabled:g}=(0,eD.Z)({isSyop:h}),{handleSuggestionSelect:x}=(0,q.$)(),m=(0,K.YO)({pillLabels:u.map(e=>e.label),maxWidth:e});return(0,d.jsxs)(s.kC,{direction:"column",gap:Q.Lo,children:[(0,d.jsx)(e6,{prototypeSLP:g,title:p._('Recent searches', 'Recent searches heading in search autocomplete', 'Recent searches heading in search autocomplete')}),g?(0,d.jsx)(e3,{containerWidth:e,numItems:u.length,prototypeSLP:g,repType:"recentSearch",children:({width:e,height:i})=>u.map((r,s)=>(0,d.jsx)(e$,{groupIndex:n,height:i,images:r.image_preview_pins?.map(e=>({"236x":{...e.image_medium_size_pixels,url:e.image_medium_url}})),isHovered:t===s,onClick:()=>{x({suggestion:r,index:s})},onMouseEnter:()=>{a(s)},onMouseLeave:()=>{o()},searchBoxRenderStopwatch:c,showRemoveButton:!0,slotIndex:s,suggestion:r,title:r.label,url:(0,K.Ek)({suggestion:r,query:""}),width:e},r.label))}):(0,d.jsx)(s.xu,{display:"flex",overflow:"hidden",position:"relative",children:u.slice(0,m).map((e,i)=>(0,d.jsx)(e8,{focusedIndex:t,groupIndex:n,index:i,onSuggestionMouseEnter:a,onSuggestionMouseLeave:o,suggestion:e},e.label))})]})}function te({focusedIndex:e,groupIndex:t,onSuggestionMouseEnter:n,onSuggestionMouseLeave:s,suggestions:a}){(0,r.useEffect)(()=>{(0,i.Z)("SuggestionGroups","/app/www/discover/SearchBox/SuggestionGroups.tsx")},[]);let o=(0,l.Z)();return(0,eU.Q)({component:13843,view_parameter:103,view_type:Q.Ie}),(0,d.jsx)(e7,{componentType:13843,focusedIndex:e,groupIndex:t,keyPrefix:"recent_view",onSuggestionMouseEnter:n,onSuggestionMouseLeave:s,seeMoreUrl:"/recently-viewed/",suggestions:a,title:o._('Recently viewed', 'searchBox.recentSavedSuggestions.heading', 'Recently viewed Pins heading in search autocomplete')})}function tt({groupIndex:e,focusedIndex:t,onSuggestionMouseEnter:n,onSuggestionMouseLeave:a,searchBoxRenderStopwatch:o,suggestions:l}){(0,r.useEffect)(()=>{(0,i.Z)("SuggestionGroups","/app/www/discover/SearchBox/SuggestionGroups.tsx")},[]);let c=Q.Ie,{id:u,items:p,story_type:h,title:{format:g}}=l,{handleSuggestionSelect:x,getSuggestionImpressionOptions:m}=(0,q.$)(),_=p.map(({type:e,id:t})=>e+":"+t).join("|");return(0,d.jsxs)(s.kC,{direction:"column",gap:Q.Lo,children:[(0,d.jsx)(e6,{title:g}),(0,d.jsx)(ew,{impressionTrackerProps:m({additionalAuxData:{content_ids:_,story_id:u,story_type:h},suggestion:p[0],index:e,groupIndex:e,loggingId:u}),children:({impressionTrackerRef:i})=>(0,d.jsx)(s.xu,{ref:i,display:"flex",marginBottom:5,wrap:!0,children:p.map((i,r)=>{let l=t===r;return(0,d.jsx)(s.xu,{"aria-selected":l?"true":"false","data-test-id":"search-suggestion-today-bubble",id:(0,K.Gp)(e,r),marginBottom:2,paddingX:1,role:"option",children:(0,d.jsx)(eJ,{bubble:i,component:13525,height:Q.Ny,isHovered:l,onClick:()=>{x({suggestion:i,index:r})},onMouseEnter:()=>{n(r)},onMouseLeave:()=>{a()},searchBoxRenderStopwatch:o,slotIndex:r,storyId:u,storyType:h,viewParameter:3467,viewType:c,width:Q.Ny})},`story--${e}-${r}`)})})})]})}function tn({containerWidth:e,focusedIndex:t,groupIndex:n,index:a,onSuggestionMouseEnter:l,onSuggestionMouseLeave:c,searchBoxRenderStopwatch:u,suggestions:p}){(0,r.useEffect)(()=>{(0,i.Z)("SuggestionGroups","/app/www/discover/SearchBox/SuggestionGroups.tsx")},[]);let{logContextEvent:h}=(0,o.u)(),{isSyop:g}=(0,q.$)(),[x,m]=(0,r.useState)(!1),{action:_,id:f,items:y,story_type:v,title:{format:b}}=p,S=y[0]&&"explorearticle"===y[0].type&&y[0].story_category,{anyEnabled:w}=(0,eD.Z)({isSyop:g}),I="shopping_spotlight"===v,{handleSuggestionSelect:j,getSuggestionImpressionOptions:k}=(0,q.$)(),E=y.map(({type:e,id:t})=>e+":"+t).join("|"),A=(0,eN.Z)(0),P=async e=>{await (0,eG.Z)({url:"/v3/search/recent/",method:"DELETE",data:{query:e}})},T=_&&_.text?{text:_.text,onClick:()=>{p.custom_properties?.recent_searches?.forEach(e=>P(e)),A()},onFocus:()=>{m(!0)},onBlur:()=>{m(!1)}}:void 0;return(0,d.jsxs)(s.kC,{dataTestId:"search-story-suggestions-container",direction:"column",gap:Q.Lo,children:[(0,d.jsx)(e6,{action:T,prototypeSLP:w,title:b}),(0,d.jsx)(ew,{impressionTrackerProps:k({additionalAuxData:{content_ids:E,story_id:f,story_type:v},suggestion:y[0],index:n,groupIndex:n,loggingId:f}),children:({impressionTrackerRef:i})=>(0,d.jsx)(s.xu,{ref:i,children:(0,d.jsx)(e3,{containerWidth:e,numItems:y.length,prototypeSLP:w,repType:2===S?"trending":"default",children:({width:e,height:i})=>y.map((r,o)=>{let p=a+o;if(I){let{id:e}=r;return(0,d.jsx)(eJ,{bubble:r,height:Q.Ny,onClick:()=>{h({component:200,event_type:101,view_parameter:3467,view_type:2,aux_data:{article_id:e,autocomplete_type:"recommended_article",story_type:v}})},onMouseDown:({event:e})=>e.preventDefault(),slotIndex:p,viewParameter:3467,viewType:2,width:Q.Ny},`ss-bubble-${e}`)}{let a=x||t===p,{cover_images:h,dominant_colors:g,id:m,story_category:_,title:{format:y},subtitle:b,identifier_icon_type:S}=r,w=(0,K.Ek)({suggestion:r,query:"",suggestionStoryId:f});return(0,d.jsx)(s.xu,{"aria-selected":a?"true":"false","data-test-id":"search-suggestion",id:(0,K.Gp)(n,o),role:"option",children:(0,d.jsx)(e$,{contextLogData:{story_type:v,content_ids:E,grid_index:o,story_id:f},dominantColor:g?.[0]??"",groupIndex:n,height:i,icon:S,images:h,isHovered:a,onClick:()=>{j({suggestion:r,index:p,suggestionStoryId:f})},onMouseEnter:()=>{l(p)},onMouseLeave:()=>{c()},searchBoxRenderStopwatch:u,slotIndex:p,subtitle:b?.format,suggestion:r,title:y,url:w,width:e})},`story-${_??""}-${n}-${m}`)}})})})})]})}var ti=n(773919),tr=n(217616),ts=n(889162);function ta({query:e,searchBoxHeight:t,searchBoxRenderStopwatch:n,showSyopHeading:a,suggestionGroups:o,width:c}){(0,r.useEffect)(()=>{(0,i.Z)("SuggestionsMenu","/app/www/discover/SearchBox/SuggestionsMenu.tsx")},[]);let u=(0,r.useRef)(null),p=(0,l.Z)(),{experiencesMulti:h}=(0,ey.Ow)(1000315),{enabled:g}=(0,tr.Z)(),{enabled:x}=(0,ts.Z)(),m=g||x,{country:_,isAuthenticated:f}=(0,F.B)(),{suggestionsFocusIndex:y,suggestionsMaxHeight:v,setSuggestionsHovered:b,setSuggestionsFocusIndex:w,handleFeaturedBoardSubmit:I,isSyop:j}=(0,q.$)(),{anyEnabled:k}=(0,eD.Z)({isSyop:j}),[E,A]=(0,r.useState)(0),P=(0,ef.Z)(A,400),T=(0,ti.Cm)(f,_),{isRTL:L}=(0,F.B)();function C(){w(void 0)}(0,r.useLayoutEffect)(()=>{if(!u.current)return()=>{};A(u.current.getBoundingClientRect().width);let e=new ResizeObserver(()=>{P(e=>u.current?.getBoundingClientRect().width||e)});return e.observe(u.current),()=>{e.disconnect()}},[P]);let Z=m?`0 0 ${es.kl}px ${es.kl}px`:"0 0 16px 16px";return(0,d.jsx)(ev.Z,{view:Q.Ie,viewParameter:103,children:o.length>0?(0,d.jsx)(s.xu,{color:"default",dangerouslySetInlineStyle:{__style:{borderRadius:Z,top:t,...m?g?L?{right:"-16px",left:"-24px"}:{left:"-16px",right:"-24px"}:{left:"-24px",right:"-12px"}:{}}},id:"SuggestionsMenu",left:!0,overflow:"hidden",position:"absolute",role:"listbox",width:m?void 0:c||"100%",children:(0,d.jsx)("div",{"data-test-id":"typeaheadResults",onMouseEnter:()=>b(!0),onMouseLeave:()=>b(!1),style:{maxHeight:v,boxSizing:"content-box",overflowY:"auto"},children:(0,d.jsxs)(s.xu,{ref:u,color:"default",dangerouslySetInlineStyle:{__style:{borderRadius:Z,paddingBottom:"4px",paddingTop:k?"28px":"32px"}},direction:"column",display:"flex",overflow:"hidden",width:"100%",children:[a&&(0,d.jsx)(s.xu,{marginBottom:4,marginStart:8,marginTop:4,children:(0,d.jsx)(s.qd,{size:"600",children:e.length>0?(0,S.nk)(p._('Search your Pins for {{ query }}', 'searchBox.suggestionsMenu.searchYourPinsForQueryText', 'Heading for search autocomplete when searching your own Pins for specific query'),{query:e}):p._('Search your Pins', 'searchBox.suggestionsMenu.searchYourPinsText', 'Heading for search autocomplete when searching your own Pins')})}),o.map((t,i)=>t.items.length?(0,d.jsx)(s.xu,{marginBottom:k?9:4,paddingX:Q.r5,children:function(t,i,r){let s=(0,K.cW)(o),a=null==y?void 0:y-s[i],l=e=>{w((0,K.cW)(o)[i]+e)};if("story"===t.type&&"shopping_spotlight"===t.story_type&&T)return(0,d.jsx)(eB.Z,{handleFeaturedBoardSubmit:I});switch(t.type){case"recent_query":return(0,d.jsx)(e9,{containerWidth:r,focusedIndex:a,groupIndex:i,onSuggestionMouseEnter:l,onSuggestionMouseLeave:C,searchBoxRenderStopwatch:n,suggestions:t.items});case"recent_save":return(0,d.jsx)(e4,{focusedIndex:a,groupIndex:i,onSuggestionMouseEnter:l,onSuggestionMouseLeave:C,suggestions:t.items});case"recent_view":return(0,d.jsx)(te,{focusedIndex:a,groupIndex:i,onSuggestionMouseEnter:l,onSuggestionMouseLeave:C,suggestions:t.items});case"story":return"shopping_spotlight"===t.story_type?(0,d.jsx)(tt,{containerWidth:r,focusedIndex:a,groupIndex:i,index:0,onSuggestionMouseEnter:l,onSuggestionMouseLeave:C,searchBoxRenderStopwatch:n,suggestions:t}):(0,d.jsx)(tn,{containerWidth:r,focusedIndex:a,groupIndex:i,index:0,onSuggestionMouseEnter:l,onSuggestionMouseLeave:C,searchBoxRenderStopwatch:n,suggestions:t});case"blended_autocomplete":return(0,d.jsx)(eZ,{experiences:h,focusedIndex:a,onSuggestionMouseEnter:l,onSuggestionMouseLeave:C,query:e,suggestions:t.items})}return null}(t,i,E)},`${e}-${t.type}-${t.title?.format??""}`):null)]})})}):(0,d.jsx)(s.xu,{})})}function to({searchBoxHeight:e,suggestionGroups:t,width:n}){(0,r.useEffect)(()=>{(0,i.Z)("SuggestionsMenuContainer","/app/www/discover/SearchBox/SuggestionsMenuContainer.tsx")},[]);let s=R(),a=M(),{isBot:o}=(0,F.B)(),l=(0,N.Z)(),{autocompleteRequestSurface:c,enteredScope:u,enteredQuery:p,updateSuggestionGroups:h,isInTypeaheadSession:x,isSyop:m}=(0,q.$)();(0,r.useEffect)(()=>{x&&!m&&(p?(a?.isTiming&&a?.abort("pivoted"),a?.start()):s?.isTiming||s?.start())},[x,m,p]);let{data:_}=(0,g.Z)(o?null:{name:"SearchTabResource"}),{state:{recentSaves:f,recentViews:y}}=ep(),v=(0,e_.X)({autocompleteRequestSurface:c}),b=(0,e_.c)({query:p,scope:u,autocompleteRequestSurface:c});return(0,r.useEffect)(()=>{let e=_||[],t=l.isAuth?e.filter(e=>"shopping_spotlight"!==e.story_type):e;h(m?[{items:v,type:"recent_query"},{items:y,type:"recent_view"},{items:f,type:"recent_save"}]:p.length?b:[{items:v,type:"recent_query"},...t||[]])},[b,m,h,p,_,v,f,y,u,l]),x&&t.length>0&&(0,d.jsx)(ta,{query:p,searchBoxHeight:e,searchBoxRenderStopwatch:s,showSyopHeading:m,suggestionGroups:t,width:n})}var tl=n(148),tc=n(875417);let td={v:"4.8.0",meta:{g:"LottieFiles AE 3.6.0",a:"",k:"",d:"",tc:""},fr:25,ip:0,op:75,w:24,h:24,nm:"lottie_loop_3_sec",ddd:0,assets:[],layers:[{ddd:0,ind:1,ty:4,nm:"Shape Layer 5",sr:1,ks:{o:{a:0,k:100,ix:11},r:{a:0,k:0,ix:10},p:{a:0,k:[22.062,12,0],ix:2},a:{a:0,k:[-10.125,-.031,0],ix:1},s:{a:0,k:[100,100,100],ix:6}},ao:0,shapes:[{ty:"gr",it:[{ind:0,ty:"sh",ix:1,ks:{a:1,k:[{i:{x:.667,y:1},o:{x:.333,y:0},t:0,s:[{i:[[0,0],[0,0]],o:[[0,0],[0,0]],v:[[-10.125,-4.75],[-10.125,4.688]],c:!1}]},{i:{x:.667,y:1},o:{x:.333,y:0},t:5,s:[{i:[[0,0],[0,0]],o:[[0,0],[0,0]],v:[[-10.125,-.703],[-10.125,.641]],c:!1}]},{i:{x:.667,y:1},o:{x:.333,y:0},t:12,s:[{i:[[0,0],[0,0]],o:[[0,0],[0,0]],v:[[-10.125,-7.685],[-10.125,7.748]],c:!1}]},{i:{x:.667,y:1},o:{x:.333,y:0},t:20,s:[{i:[[0,0],[0,0]],o:[[0,0],[0,0]],v:[[-10.125,-3],[-10.125,2.938]],c:!1}]},{i:{x:.667,y:1},o:{x:.333,y:0},t:25,s:[{i:[[0,0],[0,0]],o:[[0,0],[0,0]],v:[[-10.125,-5.704],[-10.125,5.714]],c:!1}]},{i:{x:.667,y:1},o:{x:.333,y:0},t:32,s:[{i:[[0,0],[0,0]],o:[[0,0],[0,0]],v:[[-10.125,-3.25],[-10.125,3.194]],c:!1}]},{i:{x:.667,y:1},o:{x:.333,y:0},t:39,s:[{i:[[0,0],[0,0]],o:[[0,0],[0,0]],v:[[-10.125,-4.544],[-10.125,4.522]],c:!1}]},{i:{x:.667,y:1},o:{x:.333,y:0},t:45,s:[{i:[[0,0],[0,0]],o:[[0,0],[0,0]],v:[[-10.125,-.703],[-10.125,.641]],c:!1}]},{i:{x:.667,y:1},o:{x:.333,y:0},t:52,s:[{i:[[0,0],[0,0]],o:[[0,0],[0,0]],v:[[-10.125,-7.685],[-10.125,7.748]],c:!1}]},{i:{x:.667,y:1},o:{x:.333,y:0},t:60,s:[{i:[[0,0],[0,0]],o:[[0,0],[0,0]],v:[[-10.125,-3],[-10.125,2.938]],c:!1}]},{i:{x:.667,y:1},o:{x:.333,y:0},t:67,s:[{i:[[0,0],[0,0]],o:[[0,0],[0,0]],v:[[-10.125,-7.685],[-10.125,7.748]],c:!1}]},{i:{x:.667,y:1},o:{x:.333,y:0},t:71,s:[{i:[[0,0],[0,0]],o:[[0,0],[0,0]],v:[[-10.125,-5.451],[-10.125,5.474]],c:!1}]},{t:76,s:[{i:[[0,0],[0,0]],o:[[0,0],[0,0]],v:[[-10.125,-4.75],[-10.125,4.688]],c:!1}]}],ix:2},nm:"Path 1",mn:"ADBE Vector Shape - Group",hd:!1},{ty:"st",c:{a:0,k:[0,0,0,1],ix:3},o:{a:0,k:100,ix:4},w:{a:0,k:2,ix:5},lc:2,lj:1,ml:4,bm:0,nm:"Stroke 1",mn:"ADBE Vector Graphic - Stroke",hd:!1},{ty:"tr",p:{a:0,k:[0,0],ix:2},a:{a:0,k:[0,0],ix:1},s:{a:0,k:[100,100],ix:3},r:{a:0,k:0,ix:6},o:{a:0,k:100,ix:7},sk:{a:0,k:0,ix:4},sa:{a:0,k:0,ix:5},nm:"Transform"}],nm:"Shape 1",np:3,cix:2,bm:0,ix:1,mn:"ADBE Vector Group",hd:!1}],ip:0,op:165,st:0,bm:0},{ddd:0,ind:2,ty:4,nm:"Shape Layer 4",sr:1,ks:{o:{a:0,k:100,ix:11},r:{a:0,k:0,ix:10},p:{a:0,k:[17.047,12,0],ix:2},a:{a:0,k:[-10.125,-.031,0],ix:1},s:{a:0,k:[100,100,100],ix:6}},ao:0,shapes:[{ty:"gr",it:[{ind:0,ty:"sh",ix:1,ks:{a:1,k:[{i:{x:.667,y:1},o:{x:.333,y:0},t:0,s:[{i:[[0,0],[0,0]],o:[[0,0],[0,0]],v:[[-10.141,-7.875],[-10.141,7.875]],c:!1}]},{i:{x:.667,y:1},o:{x:.333,y:0},t:7,s:[{i:[[0,0],[0,0]],o:[[0,0],[0,0]],v:[[-10.125,-3],[-10.125,2.938]],c:!1}]},{i:{x:.667,y:1},o:{x:.333,y:0},t:18,s:[{i:[[0,0],[0,0]],o:[[0,0],[0,0]],v:[[-10.135,-6.147],[-10.135,6.125]],c:!1}]},{i:{x:.667,y:1},o:{x:.333,y:0},t:27,s:[{i:[[0,0],[0,0]],o:[[0,0],[0,0]],v:[[-10.165,-1.59],[-10.165,1.514]],c:!1}]},{i:{x:.667,y:1},o:{x:.333,y:0},t:38,s:[{i:[[0,0],[0,0]],o:[[0,0],[0,0]],v:[[-10.141,-7.875],[-10.141,7.875]],c:!1}]},{i:{x:.667,y:1},o:{x:.333,y:0},t:46,s:[{i:[[0,0],[0,0]],o:[[0,0],[0,0]],v:[[-10.154,-4.346],[-10.154,4.304]],c:!1}]},{i:{x:.667,y:1},o:{x:.333,y:0},t:53,s:[{i:[[0,0],[0,0]],o:[[0,0],[0,0]],v:[[-10.151,-4.706],[-10.151,4.668]],c:!1}]},{i:{x:.667,y:1},o:{x:.333,y:0},t:63,s:[{i:[[0,0],[0,0]],o:[[0,0],[0,0]],v:[[-10.165,-1.59],[-10.165,1.514]],c:!1}]},{i:{x:.667,y:1},o:{x:.333,y:0},t:71,s:[{i:[[0,0],[0,0]],o:[[0,0],[0,0]],v:[[-10.135,-6.147],[-10.135,6.125]],c:!1}]},{t:76,s:[{i:[[0,0],[0,0]],o:[[0,0],[0,0]],v:[[-10.141,-7.875],[-10.141,7.875]],c:!1}]}],ix:2},nm:"Path 1",mn:"ADBE Vector Shape - Group",hd:!1},{ty:"st",c:{a:0,k:[0,0,0,1],ix:3},o:{a:0,k:100,ix:4},w:{a:0,k:2,ix:5},lc:2,lj:1,ml:4,bm:0,nm:"Stroke 1",mn:"ADBE Vector Graphic - Stroke",hd:!1},{ty:"tr",p:{a:0,k:[0,0],ix:2},a:{a:0,k:[0,0],ix:1},s:{a:0,k:[100,100],ix:3},r:{a:0,k:0,ix:6},o:{a:0,k:100,ix:7},sk:{a:0,k:0,ix:4},sa:{a:0,k:0,ix:5},nm:"Transform"}],nm:"Shape 1",np:3,cix:2,bm:0,ix:1,mn:"ADBE Vector Group",hd:!1}],ip:0,op:165,st:0,bm:0},{ddd:0,ind:3,ty:4,nm:"Shape Layer 3",sr:1,ks:{o:{a:0,k:100,ix:11},r:{a:0,k:0,ix:10},p:{a:0,k:[12.031,12,0],ix:2},a:{a:0,k:[-10.125,-.031,0],ix:1},s:{a:0,k:[100,100,100],ix:6}},ao:0,shapes:[{ty:"gr",it:[{ind:0,ty:"sh",ix:1,ks:{a:1,k:[{i:{x:.667,y:1},o:{x:.333,y:0},t:0,s:[{i:[[0,0],[0,0]],o:[[0,0],[0,0]],v:[[-10.125,-3],[-10.125,2.938]],c:!1}]},{i:{x:.667,y:1},o:{x:.333,y:0},t:13,s:[{i:[[0,0],[0,0]],o:[[0,0],[0,0]],v:[[-10.145,-5.963],[-10.145,5.901]],c:!1}]},{i:{x:.667,y:1},o:{x:.333,y:0},t:24,s:[{i:[[0,0],[0,0]],o:[[0,0],[0,0]],v:[[-10.141,-.622],[-10.141,.622]],c:!1}]},{i:{x:.667,y:1},o:{x:.333,y:0},t:33,s:[{i:[[0,0],[0,0]],o:[[0,0],[0,0]],v:[[-10.154,-6.64],[-10.154,6.587]],c:!1}]},{i:{x:.667,y:1},o:{x:.333,y:0},t:42,s:[{i:[[0,0],[0,0]],o:[[0,0],[0,0]],v:[[-10.141,-.622],[-10.141,.622]],c:!1}]},{i:{x:.667,y:1},o:{x:.333,y:0},t:50,s:[{i:[[0,0],[0,0]],o:[[0,0],[0,0]],v:[[-10.156,-7.75],[-10.156,7.688]],c:!1}]},{i:{x:.667,y:1},o:{x:.333,y:0},t:60,s:[{i:[[0,0],[0,0]],o:[[0,0],[0,0]],v:[[-10.15,-4.91],[-10.15,4.872]],c:!1}]},{i:{x:.667,y:1},o:{x:.333,y:0},t:67,s:[{i:[[0,0],[0,0]],o:[[0,0],[0,0]],v:[[-10.154,-6.64],[-10.154,6.587]],c:!1}]},{t:76,s:[{i:[[0,0],[0,0]],o:[[0,0],[0,0]],v:[[-10.125,-3],[-10.125,2.938]],c:!1}]}],ix:2},nm:"Path 1",mn:"ADBE Vector Shape - Group",hd:!1},{ty:"st",c:{a:0,k:[0,0,0,1],ix:3},o:{a:0,k:100,ix:4},w:{a:0,k:2,ix:5},lc:2,lj:1,ml:4,bm:0,nm:"Stroke 1",mn:"ADBE Vector Graphic - Stroke",hd:!1},{ty:"tr",p:{a:0,k:[0,0],ix:2},a:{a:0,k:[0,0],ix:1},s:{a:0,k:[100,100],ix:3},r:{a:0,k:0,ix:6},o:{a:0,k:100,ix:7},sk:{a:0,k:0,ix:4},sa:{a:0,k:0,ix:5},nm:"Transform"}],nm:"Shape 1",np:3,cix:2,bm:0,ix:1,mn:"ADBE Vector Group",hd:!1}],ip:0,op:165,st:0,bm:0},{ddd:0,ind:4,ty:4,nm:"Shape Layer 2",sr:1,ks:{o:{a:0,k:100,ix:11},r:{a:0,k:0,ix:10},p:{a:0,k:[7.016,12,0],ix:2},a:{a:0,k:[-10.125,-.031,0],ix:1},s:{a:0,k:[100,100,100],ix:6}},ao:0,shapes:[{ty:"gr",it:[{ind:0,ty:"sh",ix:1,ks:{a:1,k:[{i:{x:.667,y:1},o:{x:.333,y:0},t:0,s:[{i:[[0,0],[0,0]],o:[[0,0],[0,0]],v:[[-10.109,-6.062],[-10.109,5.688]],c:!1}]},{i:{x:.667,y:1},o:{x:.333,y:0},t:10,s:[{i:[[0,0],[0,0]],o:[[0,0],[0,0]],v:[[-10.125,-3],[-10.125,2.938]],c:!1}]},{i:{x:.667,y:1},o:{x:.333,y:0},t:20,s:[{i:[[0,0],[0,0]],o:[[0,0],[0,0]],v:[[-10.109,-7.688],[-10.109,7.562]],c:!1}]},{i:{x:.667,y:1},o:{x:.333,y:0},t:29,s:[{i:[[0,0],[0,0]],o:[[0,0],[0,0]],v:[[-10.109,-.938],[-10.141,.938]],c:!1}]},{i:{x:.667,y:1},o:{x:.333,y:0},t:39,s:[{i:[[0,0],[0,0]],o:[[0,0],[0,0]],v:[[-10.109,-4.734],[-10.117,4.456]],c:!1}]},{i:{x:.667,y:1},o:{x:.333,y:0},t:46,s:[{i:[[0,0],[0,0]],o:[[0,0],[0,0]],v:[[-10.109,-.938],[-10.141,.938]],c:!1}]},{i:{x:.667,y:1},o:{x:.333,y:0},t:56,s:[{i:[[0,0],[0,0]],o:[[0,0],[0,0]],v:[[-10.109,-5.148],[-10.121,5.07]],c:!1}]},{i:{x:.667,y:1},o:{x:.333,y:0},t:65,s:[{i:[[0,0],[0,0]],o:[[0,0],[0,0]],v:[[-10.109,-1.818],[-10.137,1.802]],c:!1}]},{t:76,s:[{i:[[0,0],[0,0]],o:[[0,0],[0,0]],v:[[-10.109,-6.062],[-10.109,5.688]],c:!1}]}],ix:2},nm:"Path 1",mn:"ADBE Vector Shape - Group",hd:!1},{ty:"st",c:{a:0,k:[0,0,0,1],ix:3},o:{a:0,k:100,ix:4},w:{a:0,k:2,ix:5},lc:2,lj:1,ml:4,bm:0,nm:"Stroke 1",mn:"ADBE Vector Graphic - Stroke",hd:!1},{ty:"tr",p:{a:0,k:[0,0],ix:2},a:{a:0,k:[0,0],ix:1},s:{a:0,k:[100,100],ix:3},r:{a:0,k:0,ix:6},o:{a:0,k:100,ix:7},sk:{a:0,k:0,ix:4},sa:{a:0,k:0,ix:5},nm:"Transform"}],nm:"Shape 1",np:3,cix:2,bm:0,ix:1,mn:"ADBE Vector Group",hd:!1}],ip:0,op:165,st:0,bm:0},{ddd:0,ind:5,ty:4,nm:"Shape Layer 1",sr:1,ks:{o:{a:0,k:100,ix:11},r:{a:0,k:0,ix:10},p:{a:0,k:[2,12,0],ix:2},a:{a:0,k:[-10.125,-.031,0],ix:1},s:{a:0,k:[100,100,100],ix:6}},ao:0,shapes:[{ty:"gr",it:[{ind:0,ty:"sh",ix:1,ks:{a:1,k:[{i:{x:.667,y:1},o:{x:.333,y:0},t:0,s:[{i:[[0,0],[0,0]],o:[[0,0],[0,0]],v:[[-10.125,-2.062],[-10.125,2.188]],c:!1}]},{i:{x:.667,y:1},o:{x:.333,y:0},t:7,s:[{i:[[0,0],[0,0]],o:[[0,0],[0,0]],v:[[-10.125,-7.688],[-10.125,7.562]],c:!1}]},{i:{x:.667,y:1},o:{x:.333,y:0},t:17,s:[{i:[[0,0],[0,0]],o:[[0,0],[0,0]],v:[[-10.125,-2.062],[-10.125,2.188]],c:!1}]},{i:{x:.667,y:1},o:{x:.333,y:0},t:26,s:[{i:[[0,0],[0,0]],o:[[0,0],[0,0]],v:[[-10.125,-5.438],[-10.125,5.413]],c:!1}]},{i:{x:.667,y:1},o:{x:.333,y:0},t:33,s:[{i:[[0,0],[0,0]],o:[[0,0],[0,0]],v:[[-10.125,-1.062],[-10.125,1]],c:!1}]},{i:{x:.667,y:1},o:{x:.333,y:0},t:40,s:[{i:[[0,0],[0,0]],o:[[0,0],[0,0]],v:[[-10.125,-6.851],[-10.125,6.734]],c:!1}]},{i:{x:.667,y:1},o:{x:.333,y:0},t:50,s:[{i:[[0,0],[0,0]],o:[[0,0],[0,0]],v:[[-10.125,-2.062],[-10.125,2.188]],c:!1}]},{i:{x:.667,y:1},o:{x:.333,y:0},t:60,s:[{i:[[0,0],[0,0]],o:[[0,0],[0,0]],v:[[-10.125,-7.688],[-10.125,7.562]],c:!1}]},{i:{x:.667,y:1},o:{x:.333,y:0},t:70,s:[{i:[[0,0],[0,0]],o:[[0,0],[0,0]],v:[[-10.125,-2.062],[-10.125,2.188]],c:!1}]},{t:76,s:[{i:[[0,0],[0,0]],o:[[0,0],[0,0]],v:[[-10.125,-2.062],[-10.125,2.188]],c:!1}]}],ix:2},nm:"Path 1",mn:"ADBE Vector Shape - Group",hd:!1},{ty:"st",c:{a:0,k:[0,0,0,1],ix:3},o:{a:0,k:100,ix:4},w:{a:0,k:2,ix:5},lc:2,lj:1,ml:4,bm:0,nm:"Stroke 1",mn:"ADBE Vector Graphic - Stroke",hd:!1},{ty:"tr",p:{a:0,k:[0,0],ix:2},a:{a:0,k:[0,0],ix:1},s:{a:0,k:[100,100],ix:3},r:{a:0,k:0,ix:6},o:{a:0,k:100,ix:7},sk:{a:0,k:0,ix:4},sa:{a:0,k:0,ix:5},nm:"Transform"}],nm:"Shape 1",np:3,cix:2,bm:0,ix:1,mn:"ADBE Vector Group",hd:!1}],ip:0,op:165,st:0,bm:0}],markers:[{tm:75,cm:"",dr:0}]};function tu(){(0,r.useEffect)(()=>{(0,i.Z)("AudioBars","/app/www/inclusiveProduct/VoiceSearch/AudioBars.tsx")},[]);let e=(0,l.Z)(),{animationContainerRef:t}=(0,tc.Z)({animationData:td,loop:!0,autoplay:!0});return t?(0,d.jsx)(s.xu,{marginEnd:2,children:(0,d.jsx)(s.zd,{height:24,width:24,children:(0,d.jsx)(s.xu,{ref:t})})}):(0,d.jsx)(s.xu,{paddingX:4,children:(0,d.jsx)(s.JO,{accessibilityLabel:e._('Listening...', 'searchBox.voiceSearch.accessibilityLabel', 'Icon indicating that the microphone is listening'),color:"default",icon:"audio-bars",size:24})})}var tp=n(622900);function th({onCloseClick:e}){(0,r.useEffect)(()=>{(0,i.Z)("VoiceSearchPermissionsModal","/app/www/inclusiveProduct/VoiceSearch/VoiceSearchPermissionsModal.tsx")},[]);let t=(0,l.Z)(),{logContextEvent:n}=(0,o.u)();(0,c.Z)(()=>{n({event_type:13,view_type:Q.Ie,component:15282})});let a=()=>{n({event_type:101,view_type:Q.Ie,component:15282,element:75}),e()};return(0,d.jsx)(b.ZP,{accessibilityModalLabel:t._('Voice search permissions modal', 'voiceSearch.accessibilityLabel', 'Modal for Voice Search permissions'),align:"start",heading:(0,d.jsx)(s.qd,{accessibilityLevel:1,size:"600",children:t._('Want to use voice search?', 'voiceSearch.modal.header', 'Header for Voice Search microphone permissions')}),isOpen:!0,onDismiss:a,size:"sm",children:(0,d.jsxs)(s.xu,{direction:"column",display:"flex",paddingX:7,children:[(0,d.jsx)(s.xv,{children:t._('Go to your browser settings to let Pinterest access the microphone', 'voiceSearch.modal.message', 'Voice Search microphone permissions message')}),(0,d.jsx)(s.xu,{display:"flex",justifyContent:"end",marginBottom:6,marginTop:7,children:(0,d.jsx)(s.zx,{accessibilityLabel:t._('Close', 'voiceSearch.close.button', 'Button to close voice search permissions modal'),color:"red",onClick:a,size:"md",text:t._('Close', 'voiceSearch.close.button', 'Button to close voice search permissions modal')})})]})})}function tg(){(0,r.useEffect)(()=>{(0,i.Z)("VoiceSearchEntryPoint","/app/www/inclusiveProduct/VoiceSearch/VoiceSearchEntryPoint.tsx")},[]);let e=(0,l.Z)(),{logContextEvent:t}=(0,o.u)(),{handleTextChange:n,handleVoiceSearchSubmit:a,voiceSearchPlaceholder:u,setVoiceSearchPlaceholder:p}=(0,q.$)(),[h,g]=(0,r.useState)(!1),[x,m]=(0,r.useState)(!1),_=(0,r.useRef)(null);(0,r.useEffect)(()=>{m((0,tp.Z)())},[]),(0,c.Z)(()=>{t({event_type:120,view_type:Q.Ie,component:43,element:15977})});let f=(0,r.useCallback)(()=>{_.current&&(_.current.stop(),p(Y.K.NULL))},[p]);if((0,r.useEffect)(()=>{u===Y.K.CANCEL&&(t({event_type:101,view_type:Q.Ie,component:43,element:73,aux_data:{is_voice_search:!0}}),f(),p(Y.K.NULL))},[u,f,p,t]),!x)return null;let y=async()=>{t({event_type:101,view_type:Q.Ie,component:43,element:15977});try{let e,i=await navigator.permissions.query({name:"microphone"});if("denied"===i.state){p(Y.K.NULL),g(!0);return}let r=new(window.webkitSpeechRecognition||window.SpeechRecognition);_.current=r,r.lang="en-US",r.interimResults=!1,e=void 0,n(""),p(Y.K.NULL),r.onstart=()=>{p(Y.K.LISTENING)},r.onresult=t=>{let n=t.results?.[0]?.[0]?.transcript;n&&(e=n)},r.onerror=e=>{p(null),"permission-denied"===e.error&&g(!0)},r.onend=()=>{e&&u!==Y.K.CANCEL?(a(e),p(null)):"prompt"===i.state?p(null):(t({event_type:16683,view_type:Q.Ie,component:43,aux_data:{reason:"voice search miss"}}),p(Y.K.DEFAULT)),e=void 0},r.start()}catch(n){let e=(0,v.Z)(n,"message");t({event_type:16683,view_type:Q.Ie,component:43,aux_data:{error_message:e}})}};return(0,d.jsxs)(s.kC,{alignItems:"center",direction:"row",height:"100%",children:[u===Y.K.LISTENING?(0,d.jsx)(tu,{}):(0,d.jsx)(s.hU,{accessibilityLabel:e._('Voice search', 'searchBox.voiceSearch.accessibilityLabel', 'Icon button that initiates a voice search'),icon:"microphone",iconColor:"darkGray",onClick:y}),h&&(0,d.jsx)(th,{onCloseClick:()=>g(!1)})]})}function tx({isPartner:e=!1,widthType:t="md"}){let n=(0,l.Z)(),{isRTL:i}=(0,F.B)(),{enabled:a}=(0,er.Z)(),{enabled:o}=(0,tr.Z)(),{allowLens:c,allowVoiceSearch:p,appliedQuery:h,displayedQuery:g,endPadding:x,enteredQuery:m,enteredScope:_,handleClearSearch:f,handleScopeChange:y,handleSearchIconButtonClick:v,inputFocused:b,isContentTypeFilterHovered:S,isInTypeaheadSession:w,isLensModalOpen:I,searchBoxHovered:j,setContentTypeFilterHovered:k,setSearchBoxHovered:E,showContentTypeFilter:A,showIconOnly:P,suggestionGroups:L,voiceSearchPlaceholder:Z}=(0,q.$)(),{checkExperiment:M}=(0,C.Z)(),R=(0,O.Z)()();if(P&&!b&&!h&&!w)return(0,d.jsxs)(s.xu,{"data-test-id":"search-box-container",id:Q.v6,children:[(0,d.jsx)(s.hU,{accessibilityLabel:n._('Search icon', 'searchBox.searchIcon.accessibilityLabel', 'accessibility label for search icon only at narrow screen width'),icon:"search",iconColor:"subtle",onClick:v,size:"lg"}),R&&(0,d.jsx)(em,{})]});let D="shrink"===t?"80vw":void 0,N=t&&Object.keys(Q.ht).includes(t)&&"shrink"!==t?Q.ht[t]:"auto",$=M("dweb_search_clear_search").anyEnabled?g.length>0||Z===Y.K.LISTENING:!!g||e&&A||w||Z===Y.K.LISTENING;return(0,d.jsx)(s.xu,{"data-test-id":"search-box-container",flex:"grow",id:Q.v6,marginEnd:2*!!o,minWidth:N,paddingX:2*!o,children:(0,d.jsxs)(s.xu,{dangerouslySetInlineStyle:{__style:{backgroundColor:j?X.wU:X.Sx}},display:"flex",height:Q.XI,rounding:a?es.Qq:6,children:[(0,d.jsxs)(s.xu,{alignItems:"center",dangerouslySetInlineStyle:{__style:{padding:i?`0 16px 0 ${x}`:`0 ${x} 0 16px`,...w?{borderRadius:a?`${es.GC}px`:"24px",boxShadow:"0 0 0 4px rgba(0, 132, 255, .5)"}:{}}},display:"flex",flex:"grow",height:"100%",onMouseEnter:()=>{E(!0)},onMouseLeave:()=>{E(!1)},position:"relative",children:[!(g||b)&&(0,d.jsx)(s.xu,{flex:"none",marginEnd:2,children:(0,d.jsx)(s.JO,{accessibilityLabel:n._('Search icon', 'searchBox.searchIcon.accessibilityLabel', 'Search icon in search box'),icon:"search",size:16})}),(0,d.jsx)(J,{name:"searchBoxInput"}),$&&(0,d.jsx)(s.xu,{flex:"none",marginStart:3,children:(0,d.jsx)(s.xu,{"data-test-id":"search-cancel",children:(0,d.jsx)(s.hU,{accessibilityLabel:n._('Remove search input', 'searchBox.removeSearchInput.accessibilityLabel', 'Accessibility label to remove the search input'),icon:h?"cancel":"clear",iconColor:"darkGray",onClick:f,size:h?"sm":"lg"})})}),(0,d.jsx)(z,{children:(0,d.jsx)(B,{children:(0,d.jsx)(to,{searchBoxHeight:Q.XI+4,suggestionGroups:L,width:D})})}),R&&(0,d.jsx)(em,{}),c&&!m&&(0,d.jsx)(u,{showCancel:$,viewType:Q.Ie}),p&&(0,d.jsx)(tg,{})]}),A?(0,d.jsxs)(r.Fragment,{children:[(0,d.jsx)(s.xu,{dangerouslySetInlineStyle:{__style:{background:"#d8d8d8",borderRadius:"1px"}},height:32,margin:"auto",width:2}),(0,d.jsx)(ea,{currentlySelectedFilter:_,currentQuery:h,handleContentTypeFilterHover:()=>{e&&k(S)},handleScopeChange:y})]}):null,I&&(0,d.jsx)(T,{})]})})}function tm({handleIconOnlyChange:e,iconOnly:t=!1,isPartner:n=!1,widthType:s="md"}){return(0,r.useEffect)(()=>{(0,i.Z)("SearchBox","/app/www/discover/SearchBox/SearchBox.tsx")},[]),(0,d.jsx)(tl.v,{children:(0,d.jsx)(L.f,{children:(0,d.jsx)(eh,{children:(0,d.jsx)(q.w,{handleIconOnlyChange:e,iconOnly:t,isPartner:n,widthType:s,children:(0,d.jsx)(tx,{handleIconOnlyChange:e,iconOnly:t,isPartner:n,widthType:s})})})})})}},98557:function(e,t,n){n.d(t,{J:()=>p,q:()=>h});var i=n(686659),r=n(667294),s=n(740097),a=n(24246),o=n(216975),l=n(431006),c=n(667389),d=n(785893);let u=Math.floor(3.5);function p({id:e,children:t,isHovered:n,url:a,onClick:o,onMouseEnter:l,onMouseLeave:c,onFocus:u,onBlur:p,rounding:h}){return(0,r.useEffect)(()=>{(0,i.Z)("SuggestionReps","/app/www/discover/SearchBox/SuggestionReps.tsx")},[]),(0,d.jsx)(s.xu,{"aria-selected":n?"true":"false","data-test-id":"search-suggestion",id:e,role:"option",children:(0,d.jsx)(s.st,{active:n,children:(0,d.jsx)(s.Tg,{href:a,onBlur:p,onFocus:u,onMouseDown:({event:e})=>e.preventDefault(),onMouseEnter:l,onMouseLeave:c,onTap:({event:e,dangerouslyDisableOnNavigation:t})=>{t(),e.metaKey||e.ctrlKey||(e.preventDefault(),o())},rounding:h,children:t})})})}function h({highlightMatch:e=!1,iconName:t,imageUrl:n,isVerifiedMerchant:p=!1,label:h,onLoad:g,query:x,rounding:m,searchDelightConfig:_,subLabel:f,type:y,verified:v=!1}){(0,r.useEffect)(()=>{(0,i.Z)("SuggestionReps","/app/www/discover/SearchBox/SuggestionReps.tsx")},[]);let b=(0,a.Z)(),S="recent_pin_searches"===y?"rs-search-suggestion":n||t?"enriched-search-suggestion":"regular-search-suggestion";return(0,d.jsx)(s.xu,{"data-test-id":S,display:"flex",paddingY:+!!n,width:"100%",children:(0,d.jsxs)(s.kC,{alignItems:"center",gap:{row:2,column:0},children:[n?(0,d.jsx)(s.xu,{"data-test-id":"enriched-autocomplete-image",height:40,marginStart:u,overflow:"hidden",rounding:m&&2===m?2:"circle",width:40,children:(0,d.jsx)(s.Ee,{alt:"",color:"#efefef",fit:"cover",naturalHeight:40,naturalWidth:40,onLoad:g,role:"presentation",src:n})}):(0,d.jsx)(s.kC,{alignItems:"center",height:40,justifyContent:"center",width:40,children:(0,d.jsx)(s.JO,{accessibilityLabel:t?(0,o.nk)(b._('{{ icon}} icon', 'SearchBox.SearchSuggestion.EnrichedAutocomplete.Icon', 'contextual icon in typeahead (eg shopping tag icon to take users to product search)'),{icon:t}).join():"",color:"default",icon:t||"search",size:12})}),(0,d.jsxs)(s.kC,{alignItems:"start",direction:"column",gap:{row:0,column:1},justifyContent:"center",children:[(0,d.jsxs)(s.kC,{alignItems:"center",children:[e&&x?(0,d.jsx)(l.Z,{query:x,searchDelightConfig:_,text:h||x}):(0,d.jsx)(s.xv,{weight:"bold",children:h}),(v||p)&&(0,d.jsx)(s.xu,{marginStart:1,children:(0,d.jsx)(c.Z,{iconOnly:!0,isVerifiedIdentity:v,isVerifiedMerchant:p,size:"xs",surface:"SuggestionReps"})})]}),f&&(0,d.jsx)(s.xv,{size:"100",children:f})]})]})})}},716769:function(e,t,n){n.d(t,{X:()=>g,c:()=>h});var i=n(667294),r=n(935059),s=n(319528),a=n(24246),o=n(216975),l=n(661376),c=n(909423),d=n(477738),u=n(818282),p=n(609370);function h({query:e,scope:t,autocompleteRequestSurface:n}){let l=(0,a.Z)(),d=(0,r.Z)(),u=(0,c.Z)({allowSearchOnMount:!0,resourceName:"AdvancedTypeaheadResource",resourceOptions:{pin_scope:t,autocomplete_request_surface:n},value:e});return(0,i.useMemo)(()=>{let e=u?.map(e=>{if("query"===e.type){let{modified_filter_eligibility:t,query:n}=e,i=t?(0,o.nk)(t?.hair_pattern?.eligible_filters?l._('{{ query }} by hair pattern', 'SearchSuggestion.HairPatternFilterSuggestion', 'Suggested search for a hair pattern filter-eligible query'):l._('{{ query }} by skin tone range', 'SearchSuggestion.SkinToneFilterSuggestion', 'Suggested search for a skin tone filter-eligible query'),{query:n}).join(""):n;return{...e,label:i}}return e});if(d.isAuth)return[{items:e||[],type:"blended_autocomplete"}];let t=(0,s.Z)(e||[],e=>e.type);return[{items:["query","user"].flatMap(e=>t[e]).filter(e=>!!e),type:"blended_autocomplete"}]},[u,d,l])}function g(e){let{autocompleteRequestSurface:t}=e||{},{group:n}=(0,p.Z)({isSyop:0!==t}),{isLoaded:s,data:a}=function(e){let t=(0,r.Z)(),{autocompleteRequestSurface:n}=e||{};return(0,l.Z)(t.isAuth?{name:"AdvancedTypeaheadResource",options:{term:"",pin_scope:d.lw.PINS,autocomplete_request_surface:n},noCache:!0}:null)}(e);return(0,i.useMemo)(()=>{if(s&&a)return a.items.slice(0,n?.includes("recent_search")?u.UE:u.P$).map((e,t)=>({...e,resultIndex:t}));return[]},[s,a,n])}},657476:function(e,t,n){n.d(t,{X:()=>h,Z:()=>p});var i=n(312048),r=n(190665),s=n(501010),a=n(774838),o=n(661376),l=n(42676),c=n(477738),d=n(739405),u=n(148);function p(e){let{resource:t}=h(e);return t}function h(e){let{skipResourceCall:t}=e||{},{checkExperiment:n}=(0,s.Z)(),{isAuthenticated:p}=(0,a.B)(),{pathname:h,search:g}=(0,i.TH)(),x=(0,d.HG)(),m=!p||!x,_=(0,u.n)(),f=(0,r.Z)(),y=(0,l.vW)({searchParams:_,sourceUrl:h+g,isDesktop:x,isAuthenticated:p,appliedUnifiedFilters:f}),v=m;m&&(v=!!p&&!n("unify_search_resource_auth_mweb").anyEnabled);let b=t||_.scope===c.lw.USERS&&!m||v;return{resource:(0,o.Z)(b?null:y),options:y.options}}}}]);
//# sourceMappingURL=https://sm.pinimg.com/webapp/73576-bb030558cc8f9fd3.mjs.map